"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/settings/payments/route";
exports.ids = ["app/api/settings/payments/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsettings%2Fpayments%2Froute&page=%2Fapi%2Fsettings%2Fpayments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsettings%2Fpayments%2Froute.ts&appDir=C%3A%5CUsers%5CSonat%5CDocuments%5CVS-CODE-PROJECTS%5CPAY-STRUCTURE-ALL%5CPAY-STRUCTURE%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CSonat%5CDocuments%5CVS-CODE-PROJECTS%5CPAY-STRUCTURE-ALL%5CPAY-STRUCTURE&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsettings%2Fpayments%2Froute&page=%2Fapi%2Fsettings%2Fpayments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsettings%2Fpayments%2Froute.ts&appDir=C%3A%5CUsers%5CSonat%5CDocuments%5CVS-CODE-PROJECTS%5CPAY-STRUCTURE-ALL%5CPAY-STRUCTURE%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CSonat%5CDocuments%5CVS-CODE-PROJECTS%5CPAY-STRUCTURE-ALL%5CPAY-STRUCTURE&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Sonat_Documents_VS_CODE_PROJECTS_PAY_STRUCTURE_ALL_PAY_STRUCTURE_app_api_settings_payments_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/settings/payments/route.ts */ \"(rsc)/./app/api/settings/payments/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/settings/payments/route\",\n        pathname: \"/api/settings/payments\",\n        filename: \"route\",\n        bundlePath: \"app/api/settings/payments/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Sonat\\\\Documents\\\\VS-CODE-PROJECTS\\\\PAY-STRUCTURE-ALL\\\\PAY-STRUCTURE\\\\app\\\\api\\\\settings\\\\payments\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Sonat_Documents_VS_CODE_PROJECTS_PAY_STRUCTURE_ALL_PAY_STRUCTURE_app_api_settings_payments_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/settings/payments/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzZXR0aW5ncyUyRnBheW1lbnRzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZzZXR0aW5ncyUyRnBheW1lbnRzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc2V0dGluZ3MlMkZwYXltZW50cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNTb25hdCU1Q0RvY3VtZW50cyU1Q1ZTLUNPREUtUFJPSkVDVFMlNUNQQVktU1RSVUNUVVJFLUFMTCU1Q1BBWS1TVFJVQ1RVUkUlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q1NvbmF0JTVDRG9jdW1lbnRzJTVDVlMtQ09ERS1QUk9KRUNUUyU1Q1BBWS1TVFJVQ1RVUkUtQUxMJTVDUEFZLVNUUlVDVFVSRSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDdUU7QUFDcEo7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tb25lbGl4YS8/ZWJkOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxTb25hdFxcXFxEb2N1bWVudHNcXFxcVlMtQ09ERS1QUk9KRUNUU1xcXFxQQVktU1RSVUNUVVJFLUFMTFxcXFxQQVktU1RSVUNUVVJFXFxcXGFwcFxcXFxhcGlcXFxcc2V0dGluZ3NcXFxccGF5bWVudHNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3NldHRpbmdzL3BheW1lbnRzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc2V0dGluZ3MvcGF5bWVudHNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3NldHRpbmdzL3BheW1lbnRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcU29uYXRcXFxcRG9jdW1lbnRzXFxcXFZTLUNPREUtUFJPSkVDVFNcXFxcUEFZLVNUUlVDVFVSRS1BTExcXFxcUEFZLVNUUlVDVFVSRVxcXFxhcHBcXFxcYXBpXFxcXHNldHRpbmdzXFxcXHBheW1lbnRzXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zZXR0aW5ncy9wYXltZW50cy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsettings%2Fpayments%2Froute&page=%2Fapi%2Fsettings%2Fpayments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsettings%2Fpayments%2Froute.ts&appDir=C%3A%5CUsers%5CSonat%5CDocuments%5CVS-CODE-PROJECTS%5CPAY-STRUCTURE-ALL%5CPAY-STRUCTURE%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CSonat%5CDocuments%5CVS-CODE-PROJECTS%5CPAY-STRUCTURE-ALL%5CPAY-STRUCTURE&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/settings/payments/route.ts":
/*!********************************************!*\
  !*** ./app/api/settings/payments/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n/* harmony import */ var _lib_supabase_admin__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase/admin */ \"(rsc)/./lib/supabase/admin.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_payments__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/payments */ \"(rsc)/./lib/payments.ts\");\n\n\n\n\n\nasync function GET() {\n    try {\n        const settings = await (0,_lib_payments__WEBPACK_IMPORTED_MODULE_4__.getPaymentSettings)();\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: settings\n        });\n    } catch (error) {\n        console.error(\"Get payment settings error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to fetch payment settings\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function PUT(request) {\n    try {\n        const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const adminUser = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_3__.getAdminUser)(user.id);\n        if (!adminUser) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Not an admin\"\n            }, {\n                status: 403\n            });\n        }\n        const body = await request.json();\n        const updates = Object.entries(body).map(([key, value])=>({\n                key,\n                value: typeof value === \"object\" ? JSON.stringify(value) : String(value),\n                updated_at: new Date().toISOString()\n            }));\n        for (const update of updates){\n            await _lib_supabase_admin__WEBPACK_IMPORTED_MODULE_2__.supabaseAdmin.from(\"settings\").upsert(update, {\n                onConflict: \"key\"\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true\n        });\n    } catch (error) {\n        console.error(\"Update payment settings error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error.message || \"Failed to update settings\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3NldHRpbmdzL3BheW1lbnRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBd0Q7QUFDSDtBQUNBO0FBQ1g7QUFDVTtBQUU3QyxlQUFlSztJQUNwQixJQUFJO1FBQ0YsTUFBTUMsV0FBVyxNQUFNRixpRUFBa0JBO1FBQ3pDLE9BQU9KLHFEQUFZQSxDQUFDTyxJQUFJLENBQUM7WUFBRUMsU0FBUztZQUFNQyxNQUFNSDtRQUFTO0lBQzNELEVBQUUsT0FBT0ksT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsK0JBQStCQTtRQUM3QyxPQUFPVixxREFBWUEsQ0FBQ08sSUFBSSxDQUN0QjtZQUFFQyxTQUFTO1lBQU9FLE9BQU87UUFBbUMsR0FDNUQ7WUFBRUUsUUFBUTtRQUFJO0lBRWxCO0FBQ0Y7QUFFTyxlQUFlQyxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsTUFBTUMsV0FBV2Qsa0VBQVlBO1FBQzdCLE1BQU0sRUFBRVEsTUFBTSxFQUFFTyxJQUFJLEVBQUUsRUFBRSxHQUFHLE1BQU1ELFNBQVNFLElBQUksQ0FBQ0MsT0FBTztRQUN0RCxJQUFJLENBQUNGLE1BQU07WUFDVCxPQUFPaEIscURBQVlBLENBQUNPLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9FLE9BQU87WUFBZSxHQUN4QztnQkFBRUUsUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTU8sWUFBWSxNQUFNaEIsdURBQVlBLENBQUNhLEtBQUtJLEVBQUU7UUFDNUMsSUFBSSxDQUFDRCxXQUFXO1lBQ2QsT0FBT25CLHFEQUFZQSxDQUFDTyxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPRSxPQUFPO1lBQWUsR0FDeEM7Z0JBQUVFLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1TLE9BQU8sTUFBTVAsUUFBUVAsSUFBSTtRQUUvQixNQUFNZSxVQUFVQyxPQUFPQyxPQUFPLENBQUNILE1BQU1JLEdBQUcsQ0FBQyxDQUFDLENBQUNDLEtBQUtDLE1BQU0sR0FBTTtnQkFDMUREO2dCQUNBQyxPQUFPLE9BQU9BLFVBQVUsV0FBV0MsS0FBS0MsU0FBUyxDQUFDRixTQUFTRyxPQUFPSDtnQkFDbEVJLFlBQVksSUFBSUMsT0FBT0MsV0FBVztZQUNwQztRQUVBLEtBQUssTUFBTUMsVUFBVVosUUFBUztZQUM1QixNQUFNcEIsOERBQWFBLENBQ2hCaUMsSUFBSSxDQUFDLFlBQ0xDLE1BQU0sQ0FBQ0YsUUFBUTtnQkFBRUcsWUFBWTtZQUFNO1FBQ3hDO1FBRUEsT0FBT3JDLHFEQUFZQSxDQUFDTyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFLO0lBQzNDLEVBQUUsT0FBT0UsT0FBWTtRQUNuQkMsUUFBUUQsS0FBSyxDQUFDLGtDQUFrQ0E7UUFDaEQsT0FBT1YscURBQVlBLENBQUNPLElBQUksQ0FDdEI7WUFBRUMsU0FBUztZQUFPRSxPQUFPQSxNQUFNNEIsT0FBTyxJQUFJO1FBQTRCLEdBQ3RFO1lBQUUxQixRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21vbmVsaXhhLy4vYXBwL2FwaS9zZXR0aW5ncy9wYXltZW50cy9yb3V0ZS50cz84ZGUyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL2FkbWluJztcbmltcG9ydCB7IGdldEFkbWluVXNlciB9IGZyb20gJ0AvbGliL2F1dGgnO1xuaW1wb3J0IHsgZ2V0UGF5bWVudFNldHRpbmdzIH0gZnJvbSAnQC9saWIvcGF5bWVudHMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgZ2V0UGF5bWVudFNldHRpbmdzKCk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogc2V0dGluZ3MgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignR2V0IHBheW1lbnQgc2V0dGluZ3MgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIHBheW1lbnQgc2V0dGluZ3MnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQVVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudCgpO1xuICAgIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IGFkbWluVXNlciA9IGF3YWl0IGdldEFkbWluVXNlcih1c2VyLmlkKTtcbiAgICBpZiAoIWFkbWluVXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBhbiBhZG1pbicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMyB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgIGNvbnN0IHVwZGF0ZXMgPSBPYmplY3QuZW50cmllcyhib2R5KS5tYXAoKFtrZXksIHZhbHVlXSkgPT4gKHtcbiAgICAgIGtleSxcbiAgICAgIHZhbHVlOiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpIDogU3RyaW5nKHZhbHVlKSxcbiAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB9KSk7XG5cbiAgICBmb3IgKGNvbnN0IHVwZGF0ZSBvZiB1cGRhdGVzKSB7XG4gICAgICBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdzZXR0aW5ncycpXG4gICAgICAgIC51cHNlcnQodXBkYXRlLCB7IG9uQ29uZmxpY3Q6ICdrZXknIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdVcGRhdGUgcGF5bWVudCBzZXR0aW5ncyBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byB1cGRhdGUgc2V0dGluZ3MnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZUFkbWluIiwiZ2V0QWRtaW5Vc2VyIiwiZ2V0UGF5bWVudFNldHRpbmdzIiwiR0VUIiwic2V0dGluZ3MiLCJqc29uIiwic3VjY2VzcyIsImRhdGEiLCJlcnJvciIsImNvbnNvbGUiLCJzdGF0dXMiLCJQVVQiLCJyZXF1ZXN0Iiwic3VwYWJhc2UiLCJ1c2VyIiwiYXV0aCIsImdldFVzZXIiLCJhZG1pblVzZXIiLCJpZCIsImJvZHkiLCJ1cGRhdGVzIiwiT2JqZWN0IiwiZW50cmllcyIsIm1hcCIsImtleSIsInZhbHVlIiwiSlNPTiIsInN0cmluZ2lmeSIsIlN0cmluZyIsInVwZGF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1cGRhdGUiLCJmcm9tIiwidXBzZXJ0Iiwib25Db25mbGljdCIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/settings/payments/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createInitialAdmin: () => (/* binding */ createInitialAdmin),\n/* harmony export */   getAdminUser: () => (/* binding */ getAdminUser),\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getCustomer: () => (/* binding */ getCustomer),\n/* harmony export */   isAdmin: () => (/* binding */ isAdmin),\n/* harmony export */   updateLastLogin: () => (/* binding */ updateLastLogin)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n/* harmony import */ var _lib_supabase_admin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/admin */ \"(rsc)/./lib/supabase/admin.ts\");\n\n\n// ─────────────────────────────────────────────────────────────────\n// Get Current User\n// ─────────────────────────────────────────────────────────────────\nasync function getCurrentUser() {\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n    const { data: { user }, error } = await supabase.auth.getUser();\n    if (error || !user) return null;\n    return user;\n}\n// ─────────────────────────────────────────────────────────────────\n// Get Admin User\n// ─────────────────────────────────────────────────────────────────\nasync function getAdminUser(authUserId) {\n    const { data, error } = await _lib_supabase_admin__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"admin_users\").select(\"*\").eq(\"auth_user_id\", authUserId).eq(\"is_active\", true).single();\n    if (error || !data) return null;\n    return data;\n}\n// ─────────────────────────────────────────────────────────────────\n// Get Customer\n// ─────────────────────────────────────────────────────────────────\nasync function getCustomer(authUserId) {\n    const { data, error } = await _lib_supabase_admin__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"customers\").select(\"*\").eq(\"auth_user_id\", authUserId).single();\n    if (error || !data) return null;\n    return data;\n}\n// ─────────────────────────────────────────────────────────────────\n// Check if user is admin\n// ─────────────────────────────────────────────────────────────────\nasync function isAdmin(authUserId) {\n    const admin = await getAdminUser(authUserId);\n    return !!admin;\n}\n// ─────────────────────────────────────────────────────────────────\n// Update Last Login\n// ─────────────────────────────────────────────────────────────────\nasync function updateLastLogin(adminId, ip) {\n    await _lib_supabase_admin__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"admin_users\").update({\n        last_login_at: new Date().toISOString(),\n        last_login_ip: ip || null\n    }).eq(\"id\", adminId);\n}\n// ─────────────────────────────────────────────────────────────────\n// Create Initial Admin (ilk kurulum için)\n// ─────────────────────────────────────────────────────────────────\nasync function createInitialAdmin(authUserId, email, fullName) {\n    // Zaten admin var mı kontrol et\n    const existingAdmin = await getAdminUser(authUserId);\n    if (existingAdmin) return existingAdmin;\n    const { data, error } = await _lib_supabase_admin__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"admin_users\").insert({\n        auth_user_id: authUserId,\n        email,\n        full_name: fullName,\n        role: \"super_admin\",\n        is_active: true\n    }).select().single();\n    if (error) {\n        console.error(\"Error creating admin:\", error);\n        return null;\n    }\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFxRDtBQUNBO0FBR3JELG9FQUFvRTtBQUNwRSxtQkFBbUI7QUFDbkIsb0VBQW9FO0FBQzdELGVBQWVFO0lBQ3BCLE1BQU1DLFdBQVdILGtFQUFZQTtJQUM3QixNQUFNLEVBQ0pJLE1BQU0sRUFBRUMsSUFBSSxFQUFFLEVBQ2RDLEtBQUssRUFDTixHQUFHLE1BQU1ILFNBQVNJLElBQUksQ0FBQ0MsT0FBTztJQUUvQixJQUFJRixTQUFTLENBQUNELE1BQU0sT0FBTztJQUMzQixPQUFPQTtBQUNUO0FBRUEsb0VBQW9FO0FBQ3BFLGlCQUFpQjtBQUNqQixvRUFBb0U7QUFDN0QsZUFBZUksYUFDcEJDLFVBQWtCO0lBRWxCLE1BQU0sRUFBRU4sSUFBSSxFQUFFRSxLQUFLLEVBQUUsR0FBRyxNQUFNTCw4REFBYUEsQ0FDeENVLElBQUksQ0FBQyxlQUNMQyxNQUFNLENBQUMsS0FDUEMsRUFBRSxDQUFDLGdCQUFnQkgsWUFDbkJHLEVBQUUsQ0FBQyxhQUFhLE1BQ2hCQyxNQUFNO0lBRVQsSUFBSVIsU0FBUyxDQUFDRixNQUFNLE9BQU87SUFDM0IsT0FBT0E7QUFDVDtBQUVBLG9FQUFvRTtBQUNwRSxlQUFlO0FBQ2Ysb0VBQW9FO0FBQzdELGVBQWVXLFlBQ3BCTCxVQUFrQjtJQUVsQixNQUFNLEVBQUVOLElBQUksRUFBRUUsS0FBSyxFQUFFLEdBQUcsTUFBTUwsOERBQWFBLENBQ3hDVSxJQUFJLENBQUMsYUFDTEMsTUFBTSxDQUFDLEtBQ1BDLEVBQUUsQ0FBQyxnQkFBZ0JILFlBQ25CSSxNQUFNO0lBRVQsSUFBSVIsU0FBUyxDQUFDRixNQUFNLE9BQU87SUFDM0IsT0FBT0E7QUFDVDtBQUVBLG9FQUFvRTtBQUNwRSx5QkFBeUI7QUFDekIsb0VBQW9FO0FBQzdELGVBQWVZLFFBQVFOLFVBQWtCO0lBQzlDLE1BQU1PLFFBQVEsTUFBTVIsYUFBYUM7SUFDakMsT0FBTyxDQUFDLENBQUNPO0FBQ1g7QUFFQSxvRUFBb0U7QUFDcEUsb0JBQW9CO0FBQ3BCLG9FQUFvRTtBQUM3RCxlQUFlQyxnQkFBZ0JDLE9BQWUsRUFBRUMsRUFBVztJQUNoRSxNQUFNbkIsOERBQWFBLENBQ2hCVSxJQUFJLENBQUMsZUFDTFUsTUFBTSxDQUFDO1FBQ05DLGVBQWUsSUFBSUMsT0FBT0MsV0FBVztRQUNyQ0MsZUFBZUwsTUFBTTtJQUN2QixHQUNDUCxFQUFFLENBQUMsTUFBTU07QUFDZDtBQUVBLG9FQUFvRTtBQUNwRSwwQ0FBMEM7QUFDMUMsb0VBQW9FO0FBQzdELGVBQWVPLG1CQUNwQmhCLFVBQWtCLEVBQ2xCaUIsS0FBYSxFQUNiQyxRQUFnQjtJQUVoQixnQ0FBZ0M7SUFDaEMsTUFBTUMsZ0JBQWdCLE1BQU1wQixhQUFhQztJQUN6QyxJQUFJbUIsZUFBZSxPQUFPQTtJQUUxQixNQUFNLEVBQUV6QixJQUFJLEVBQUVFLEtBQUssRUFBRSxHQUFHLE1BQU1MLDhEQUFhQSxDQUN4Q1UsSUFBSSxDQUFDLGVBQ0xtQixNQUFNLENBQUM7UUFDTkMsY0FBY3JCO1FBQ2RpQjtRQUNBSyxXQUFXSjtRQUNYSyxNQUFNO1FBQ05DLFdBQVc7SUFDYixHQUNDdEIsTUFBTSxHQUNORSxNQUFNO0lBRVQsSUFBSVIsT0FBTztRQUNUNkIsUUFBUTdCLEtBQUssQ0FBQyx5QkFBeUJBO1FBQ3ZDLE9BQU87SUFDVDtJQUVBLE9BQU9GO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tb25lbGl4YS8uL2xpYi9hdXRoLnRzP2JmN2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmVyJztcbmltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9hZG1pbic7XG5pbXBvcnQgdHlwZSB7IEFkbWluVXNlciwgQ3VzdG9tZXIgfSBmcm9tICdAL3R5cGVzJztcblxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXG4vLyBHZXQgQ3VycmVudCBVc2VyXG4vLyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoKTtcbiAgY29uc3Qge1xuICAgIGRhdGE6IHsgdXNlciB9LFxuICAgIGVycm9yLFxuICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG5cbiAgaWYgKGVycm9yIHx8ICF1c2VyKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIHVzZXI7XG59XG5cbi8vIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxuLy8gR2V0IEFkbWluIFVzZXJcbi8vIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFkbWluVXNlcihcbiAgYXV0aFVzZXJJZDogc3RyaW5nXG4pOiBQcm9taXNlPEFkbWluVXNlciB8IG51bGw+IHtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKCdhZG1pbl91c2VycycpXG4gICAgLnNlbGVjdCgnKicpXG4gICAgLmVxKCdhdXRoX3VzZXJfaWQnLCBhdXRoVXNlcklkKVxuICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAuc2luZ2xlKCk7XG5cbiAgaWYgKGVycm9yIHx8ICFkYXRhKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIGRhdGEgYXMgQWRtaW5Vc2VyO1xufVxuXG4vLyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcbi8vIEdldCBDdXN0b21lclxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VzdG9tZXIoXG4gIGF1dGhVc2VySWQ6IHN0cmluZ1xuKTogUHJvbWlzZTxDdXN0b21lciB8IG51bGw+IHtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKCdjdXN0b21lcnMnKVxuICAgIC5zZWxlY3QoJyonKVxuICAgIC5lcSgnYXV0aF91c2VyX2lkJywgYXV0aFVzZXJJZClcbiAgICAuc2luZ2xlKCk7XG5cbiAgaWYgKGVycm9yIHx8ICFkYXRhKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIGRhdGEgYXMgQ3VzdG9tZXI7XG59XG5cbi8vIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxuLy8gQ2hlY2sgaWYgdXNlciBpcyBhZG1pblxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaXNBZG1pbihhdXRoVXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgYWRtaW4gPSBhd2FpdCBnZXRBZG1pblVzZXIoYXV0aFVzZXJJZCk7XG4gIHJldHVybiAhIWFkbWluO1xufVxuXG4vLyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcbi8vIFVwZGF0ZSBMYXN0IExvZ2luXG4vLyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVMYXN0TG9naW4oYWRtaW5JZDogc3RyaW5nLCBpcD86IHN0cmluZykge1xuICBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oJ2FkbWluX3VzZXJzJylcbiAgICAudXBkYXRlKHtcbiAgICAgIGxhc3RfbG9naW5fYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGxhc3RfbG9naW5faXA6IGlwIHx8IG51bGwsXG4gICAgfSlcbiAgICAuZXEoJ2lkJywgYWRtaW5JZCk7XG59XG5cbi8vIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxuLy8gQ3JlYXRlIEluaXRpYWwgQWRtaW4gKGlsayBrdXJ1bHVtIGnDp2luKVxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlSW5pdGlhbEFkbWluKFxuICBhdXRoVXNlcklkOiBzdHJpbmcsXG4gIGVtYWlsOiBzdHJpbmcsXG4gIGZ1bGxOYW1lOiBzdHJpbmdcbik6IFByb21pc2U8QWRtaW5Vc2VyIHwgbnVsbD4ge1xuICAvLyBaYXRlbiBhZG1pbiB2YXIgbcSxIGtvbnRyb2wgZXRcbiAgY29uc3QgZXhpc3RpbmdBZG1pbiA9IGF3YWl0IGdldEFkbWluVXNlcihhdXRoVXNlcklkKTtcbiAgaWYgKGV4aXN0aW5nQWRtaW4pIHJldHVybiBleGlzdGluZ0FkbWluO1xuXG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAuZnJvbSgnYWRtaW5fdXNlcnMnKVxuICAgIC5pbnNlcnQoe1xuICAgICAgYXV0aF91c2VyX2lkOiBhdXRoVXNlcklkLFxuICAgICAgZW1haWwsXG4gICAgICBmdWxsX25hbWU6IGZ1bGxOYW1lLFxuICAgICAgcm9sZTogJ3N1cGVyX2FkbWluJyxcbiAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcbiAgICB9KVxuICAgIC5zZWxlY3QoKVxuICAgIC5zaW5nbGUoKTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBhZG1pbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gZGF0YSBhcyBBZG1pblVzZXI7XG59Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlQWRtaW4iLCJnZXRDdXJyZW50VXNlciIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJlcnJvciIsImF1dGgiLCJnZXRVc2VyIiwiZ2V0QWRtaW5Vc2VyIiwiYXV0aFVzZXJJZCIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsImdldEN1c3RvbWVyIiwiaXNBZG1pbiIsImFkbWluIiwidXBkYXRlTGFzdExvZ2luIiwiYWRtaW5JZCIsImlwIiwidXBkYXRlIiwibGFzdF9sb2dpbl9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImxhc3RfbG9naW5faXAiLCJjcmVhdGVJbml0aWFsQWRtaW4iLCJlbWFpbCIsImZ1bGxOYW1lIiwiZXhpc3RpbmdBZG1pbiIsImluc2VydCIsImF1dGhfdXNlcl9pZCIsImZ1bGxfbmFtZSIsInJvbGUiLCJpc19hY3RpdmUiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/payments.ts":
/*!*************************!*\
  !*** ./lib/payments.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCheckoutSession: () => (/* binding */ createCheckoutSession),\n/* harmony export */   createOrder: () => (/* binding */ createOrder),\n/* harmony export */   getAvailableProviders: () => (/* binding */ getAvailableProviders),\n/* harmony export */   getPaymentSettings: () => (/* binding */ getPaymentSettings),\n/* harmony export */   updateOrderStatus: () => (/* binding */ updateOrderStatus)\n/* harmony export */ });\n/* harmony import */ var _supabase_admin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase/admin */ \"(rsc)/./lib/supabase/admin.ts\");\n/* harmony import */ var _stripe__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./stripe */ \"(rsc)/./lib/stripe.ts\");\n/* harmony import */ var _paytr__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./paytr */ \"(rsc)/./lib/paytr.ts\");\n\n\n\nasync function getPaymentSettings() {\n    const { data } = await _supabase_admin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"settings\").select(\"key, value\").in(\"key\", [\n        \"default_payment_provider\",\n        \"stripe_enabled\",\n        \"paytr_enabled\",\n        \"allow_provider_switch\"\n    ]);\n    const settings = {};\n    data?.forEach((item)=>{\n        settings[item.key] = item.value;\n    });\n    return {\n        defaultProvider: settings.default_payment_provider || \"stripe\",\n        stripeEnabled: settings.stripe_enabled === \"true\",\n        paytrEnabled: settings.paytr_enabled === \"true\",\n        allowProviderSwitch: settings.allow_provider_switch === \"true\"\n    };\n}\nasync function createOrder(params) {\n    const { productId, customerId, customerEmail, amount, currency, provider, metadata, subscriptionDuration, paymentMode } = params;\n    const { data, error } = await _supabase_admin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"orders\").insert({\n        product_id: productId,\n        customer_id: customerId || null,\n        customer_email: customerEmail,\n        amount,\n        currency,\n        status: \"pending\",\n        payment_provider: provider,\n        metadata: metadata || {},\n        subscription_duration: subscriptionDuration || null,\n        payment_mode: paymentMode || null\n    }).select().single();\n    if (error) throw error;\n    return data;\n}\nasync function createCheckoutSession(params) {\n    const { product, customer, provider, userIp, successUrl, cancelUrl, subscriptionDuration, paymentMode } = params;\n    // Ödeme tutarını hesapla\n    let amount = product.price;\n    const effectivePaymentMode = paymentMode || product.default_payment_mode || \"recurring\";\n    const effectiveDuration = subscriptionDuration || product.subscription_duration;\n    // Peşin ödeme modunda toplam tutarı hesapla\n    if (product.type === \"subscription\" && effectivePaymentMode === \"upfront\" && effectiveDuration) {\n        amount = product.price * effectiveDuration;\n    }\n    const order = await createOrder({\n        productId: product.id,\n        customerId: customer.id,\n        customerEmail: customer.email,\n        amount,\n        currency: product.currency,\n        provider,\n        subscriptionDuration: effectiveDuration,\n        paymentMode: product.type === \"subscription\" ? effectivePaymentMode : undefined\n    });\n    try {\n        if (provider === \"stripe\") {\n            const session = await (0,_stripe__WEBPACK_IMPORTED_MODULE_1__.createStripeCheckoutSession)({\n                product,\n                customerEmail: customer.email,\n                customerId: customer.id,\n                successUrl: `${successUrl}?order_id=${order.id}`,\n                cancelUrl: `${cancelUrl}?order_id=${order.id}`,\n                metadata: {\n                    order_id: order.id\n                },\n                // Süreli subscription parametreleri\n                subscriptionDuration: effectiveDuration,\n                paymentMode: effectivePaymentMode\n            });\n            await _supabase_admin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"orders\").update({\n                provider_session_id: session.sessionId,\n                status: \"processing\"\n            }).eq(\"id\", order.id);\n            return {\n                id: session.sessionId,\n                url: session.url,\n                provider: \"stripe\",\n                productId: product.id,\n                customerId: customer.id,\n                customerEmail: customer.email,\n                amount: product.price,\n                currency: product.currency,\n                successUrl,\n                cancelUrl\n            };\n        }\n        if (provider === \"paytr\") {\n            if (!userIp) throw new Error(\"User IP required for PayTR\");\n            // PayTR için modifiye edilmiş product (peşin ödeme için fiyat ayarlanmış)\n            const paytrProduct = {\n                ...product,\n                price: amount\n            };\n            const session = await (0,_paytr__WEBPACK_IMPORTED_MODULE_2__.createPayTRCheckoutSession)({\n                product: paytrProduct,\n                customer: {\n                    email: customer.email,\n                    name: customer.name || customer.email.split(\"@\")[0],\n                    phone: customer.phone,\n                    address: customer.address\n                },\n                orderId: order.id,\n                userIp,\n                successUrl: `${successUrl}?order_id=${order.id}`,\n                failUrl: `${cancelUrl}?order_id=${order.id}`,\n                subscriptionDuration: effectiveDuration,\n                paymentMode: effectivePaymentMode\n            });\n            if (!session) {\n                await _supabase_admin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"orders\").update({\n                    status: \"failed\"\n                }).eq(\"id\", order.id);\n                return null;\n            }\n            await _supabase_admin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"orders\").update({\n                provider_session_id: session.token,\n                status: \"processing\"\n            }).eq(\"id\", order.id);\n            return {\n                id: session.token,\n                url: session.iframeUrl,\n                provider: \"paytr\",\n                productId: product.id,\n                customerId: customer.id,\n                customerEmail: customer.email,\n                amount: product.price,\n                currency: product.currency,\n                successUrl,\n                cancelUrl\n            };\n        }\n        throw new Error(\"Invalid payment provider\");\n    } catch (error) {\n        await _supabase_admin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"orders\").update({\n            status: \"failed\"\n        }).eq(\"id\", order.id);\n        throw error;\n    }\n}\nasync function getAvailableProviders() {\n    const settings = await getPaymentSettings();\n    const providers = [];\n    if (settings.stripeEnabled) providers.push(\"stripe\");\n    if (settings.paytrEnabled) providers.push(\"paytr\");\n    return providers;\n}\nasync function updateOrderStatus(orderId, status, metadata) {\n    const updateData = {\n        status,\n        updated_at: new Date().toISOString()\n    };\n    if (metadata) {\n        const { data: order } = await _supabase_admin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"orders\").select(\"metadata\").eq(\"id\", orderId).single();\n        updateData.metadata = {\n            ...order?.metadata,\n            ...metadata\n        };\n    }\n    await _supabase_admin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"orders\").update(updateData).eq(\"id\", orderId);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFMEQsVUFBVUMsSUFBSSxDQUFDO0lBRTFDLE9BQU9EO0FBQ1Q7QUFFTyxlQUFlRSxrQkFDcEJQLE9BQWUsRUFDZmpDLE1BQXVCLEVBQ3ZCUixRQUE4QjtJQUU5QixNQUFNaUQsYUFBa0M7UUFDdEN6QztRQUNBMEMsWUFBWSxJQUFJQyxPQUFPQyxXQUFXO0lBQ3BDO0lBRUEsSUFBSXBELFVBQVU7UUFDWixNQUFNLEVBQUV6QixNQUFNaUQsS0FBSyxFQUFFLEdBQUcsTUFBTXJELDBEQUFhQSxDQUN4Q0ssSUFBSSxDQUFDLFVBQ0xDLE1BQU0sQ0FBQyxZQUNQd0QsRUFBRSxDQUFDLE1BQU1RLFNBQ1Q3QixNQUFNO1FBRVRxQyxXQUFXakQsUUFBUSxHQUFHO1lBQUUsR0FBR3dCLE9BQU94QixRQUFRO1lBQUUsR0FBR0EsUUFBUTtRQUFDO0lBQzFEO0lBRUEsTUFBTTdCLDBEQUFhQSxDQUFDSyxJQUFJLENBQUMsVUFBVXNELE1BQU0sQ0FBQ21CLFlBQVloQixFQUFFLENBQUMsTUFBTVE7QUFDakUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tb25lbGl4YS8uL2xpYi9wYXltZW50cy50cz9hMjY2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tICcuL3N1cGFiYXNlL2FkbWluJztcbmltcG9ydCB7IGNyZWF0ZVN0cmlwZUNoZWNrb3V0U2Vzc2lvbiB9IGZyb20gJy4vc3RyaXBlJztcbmltcG9ydCB7IGNyZWF0ZVBheVRSQ2hlY2tvdXRTZXNzaW9uIH0gZnJvbSAnLi9wYXl0cic7XG5pbXBvcnQgdHlwZSB7IFByb2R1Y3QsIE9yZGVyLCBTdWJzY3JpcHRpb25QYXltZW50TW9kZSB9IGZyb20gJ0AvdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBQYXltZW50UHJvdmlkZXIsIENoZWNrb3V0U2Vzc2lvbiB9IGZyb20gJ0AvdHlwZXMvcGF5bWVudHMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGF5bWVudFNldHRpbmdzKCkge1xuICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAuZnJvbSgnc2V0dGluZ3MnKVxuICAgIC5zZWxlY3QoJ2tleSwgdmFsdWUnKVxuICAgIC5pbigna2V5JywgW1xuICAgICAgJ2RlZmF1bHRfcGF5bWVudF9wcm92aWRlcicsXG4gICAgICAnc3RyaXBlX2VuYWJsZWQnLFxuICAgICAgJ3BheXRyX2VuYWJsZWQnLFxuICAgICAgJ2FsbG93X3Byb3ZpZGVyX3N3aXRjaCcsXG4gICAgXSk7XG5cbiAgY29uc3Qgc2V0dGluZ3M6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgZGF0YT8uZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgIHNldHRpbmdzW2l0ZW0ua2V5XSA9IGl0ZW0udmFsdWU7XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgZGVmYXVsdFByb3ZpZGVyOiAoc2V0dGluZ3MuZGVmYXVsdF9wYXltZW50X3Byb3ZpZGVyIHx8ICdzdHJpcGUnKSBhcyBQYXltZW50UHJvdmlkZXIsXG4gICAgc3RyaXBlRW5hYmxlZDogc2V0dGluZ3Muc3RyaXBlX2VuYWJsZWQgPT09ICd0cnVlJyxcbiAgICBwYXl0ckVuYWJsZWQ6IHNldHRpbmdzLnBheXRyX2VuYWJsZWQgPT09ICd0cnVlJyxcbiAgICBhbGxvd1Byb3ZpZGVyU3dpdGNoOiBzZXR0aW5ncy5hbGxvd19wcm92aWRlcl9zd2l0Y2ggPT09ICd0cnVlJyxcbiAgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU9yZGVyKHBhcmFtczoge1xuICBwcm9kdWN0SWQ6IHN0cmluZztcbiAgY3VzdG9tZXJJZD86IHN0cmluZztcbiAgY3VzdG9tZXJFbWFpbDogc3RyaW5nO1xuICBhbW91bnQ6IG51bWJlcjtcbiAgY3VycmVuY3k6IHN0cmluZztcbiAgcHJvdmlkZXI6IFBheW1lbnRQcm92aWRlcjtcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICAvLyBTw7xyZWxpIHN1YnNjcmlwdGlvbiBpw6dpblxuICBzdWJzY3JpcHRpb25EdXJhdGlvbj86IG51bWJlcjtcbiAgcGF5bWVudE1vZGU/OiBTdWJzY3JpcHRpb25QYXltZW50TW9kZTtcbn0pOiBQcm9taXNlPE9yZGVyPiB7XG4gIGNvbnN0IHtcbiAgICBwcm9kdWN0SWQsXG4gICAgY3VzdG9tZXJJZCxcbiAgICBjdXN0b21lckVtYWlsLFxuICAgIGFtb3VudCxcbiAgICBjdXJyZW5jeSxcbiAgICBwcm92aWRlcixcbiAgICBtZXRhZGF0YSxcbiAgICBzdWJzY3JpcHRpb25EdXJhdGlvbixcbiAgICBwYXltZW50TW9kZSxcbiAgfSA9IHBhcmFtcztcblxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oJ29yZGVycycpXG4gICAgLmluc2VydCh7XG4gICAgICBwcm9kdWN0X2lkOiBwcm9kdWN0SWQsXG4gICAgICBjdXN0b21lcl9pZDogY3VzdG9tZXJJZCB8fCBudWxsLFxuICAgICAgY3VzdG9tZXJfZW1haWw6IGN1c3RvbWVyRW1haWwsXG4gICAgICBhbW91bnQsXG4gICAgICBjdXJyZW5jeSxcbiAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgcGF5bWVudF9wcm92aWRlcjogcHJvdmlkZXIsXG4gICAgICBtZXRhZGF0YTogbWV0YWRhdGEgfHwge30sXG4gICAgICBzdWJzY3JpcHRpb25fZHVyYXRpb246IHN1YnNjcmlwdGlvbkR1cmF0aW9uIHx8IG51bGwsXG4gICAgICBwYXltZW50X21vZGU6IHBheW1lbnRNb2RlIHx8IG51bGwsXG4gICAgfSlcbiAgICAuc2VsZWN0KClcbiAgICAuc2luZ2xlKCk7XG5cbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgcmV0dXJuIGRhdGEgYXMgT3JkZXI7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDaGVja291dFNlc3Npb24ocGFyYW1zOiB7XG4gIHByb2R1Y3Q6IFByb2R1Y3Q7XG4gIGN1c3RvbWVyOiB7XG4gICAgaWQ/OiBzdHJpbmc7XG4gICAgZW1haWw6IHN0cmluZztcbiAgICBuYW1lPzogc3RyaW5nO1xuICAgIHBob25lPzogc3RyaW5nO1xuICAgIGFkZHJlc3M/OiBzdHJpbmc7XG4gIH07XG4gIHByb3ZpZGVyOiBQYXltZW50UHJvdmlkZXI7XG4gIHVzZXJJcD86IHN0cmluZztcbiAgc3VjY2Vzc1VybDogc3RyaW5nO1xuICBjYW5jZWxVcmw6IHN0cmluZztcbiAgLy8gU8O8cmVsaSBzdWJzY3JpcHRpb24gacOnaW5cbiAgc3Vic2NyaXB0aW9uRHVyYXRpb24/OiBudW1iZXI7XG4gIHBheW1lbnRNb2RlPzogU3Vic2NyaXB0aW9uUGF5bWVudE1vZGU7XG59KTogUHJvbWlzZTxDaGVja291dFNlc3Npb24gfCBudWxsPiB7XG4gIGNvbnN0IHsgcHJvZHVjdCwgY3VzdG9tZXIsIHByb3ZpZGVyLCB1c2VySXAsIHN1Y2Nlc3NVcmwsIGNhbmNlbFVybCwgc3Vic2NyaXB0aW9uRHVyYXRpb24sIHBheW1lbnRNb2RlIH0gPSBwYXJhbXM7XG5cbiAgLy8gw5ZkZW1lIHR1dGFyxLFuxLEgaGVzYXBsYVxuICBsZXQgYW1vdW50ID0gcHJvZHVjdC5wcmljZTtcbiAgY29uc3QgZWZmZWN0aXZlUGF5bWVudE1vZGUgPSBwYXltZW50TW9kZSB8fCBwcm9kdWN0LmRlZmF1bHRfcGF5bWVudF9tb2RlIHx8ICdyZWN1cnJpbmcnO1xuICBjb25zdCBlZmZlY3RpdmVEdXJhdGlvbiA9IHN1YnNjcmlwdGlvbkR1cmF0aW9uIHx8IHByb2R1Y3Quc3Vic2NyaXB0aW9uX2R1cmF0aW9uO1xuXG4gIC8vIFBlxZ9pbiDDtmRlbWUgbW9kdW5kYSB0b3BsYW0gdHV0YXLEsSBoZXNhcGxhXG4gIGlmIChwcm9kdWN0LnR5cGUgPT09ICdzdWJzY3JpcHRpb24nICYmIGVmZmVjdGl2ZVBheW1lbnRNb2RlID09PSAndXBmcm9udCcgJiYgZWZmZWN0aXZlRHVyYXRpb24pIHtcbiAgICBhbW91bnQgPSBwcm9kdWN0LnByaWNlICogZWZmZWN0aXZlRHVyYXRpb247XG4gIH1cblxuICBjb25zdCBvcmRlciA9IGF3YWl0IGNyZWF0ZU9yZGVyKHtcbiAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXG4gICAgY3VzdG9tZXJJZDogY3VzdG9tZXIuaWQsXG4gICAgY3VzdG9tZXJFbWFpbDogY3VzdG9tZXIuZW1haWwsXG4gICAgYW1vdW50LFxuICAgIGN1cnJlbmN5OiBwcm9kdWN0LmN1cnJlbmN5LFxuICAgIHByb3ZpZGVyLFxuICAgIHN1YnNjcmlwdGlvbkR1cmF0aW9uOiBlZmZlY3RpdmVEdXJhdGlvbixcbiAgICBwYXltZW50TW9kZTogcHJvZHVjdC50eXBlID09PSAnc3Vic2NyaXB0aW9uJyA/IGVmZmVjdGl2ZVBheW1lbnRNb2RlIDogdW5kZWZpbmVkLFxuICB9KTtcblxuICB0cnkge1xuICAgIGlmIChwcm92aWRlciA9PT0gJ3N0cmlwZScpIHtcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjcmVhdGVTdHJpcGVDaGVja291dFNlc3Npb24oe1xuICAgICAgICBwcm9kdWN0LFxuICAgICAgICBjdXN0b21lckVtYWlsOiBjdXN0b21lci5lbWFpbCxcbiAgICAgICAgY3VzdG9tZXJJZDogY3VzdG9tZXIuaWQsXG4gICAgICAgIHN1Y2Nlc3NVcmw6IGAke3N1Y2Nlc3NVcmx9P29yZGVyX2lkPSR7b3JkZXIuaWR9YCxcbiAgICAgICAgY2FuY2VsVXJsOiBgJHtjYW5jZWxVcmx9P29yZGVyX2lkPSR7b3JkZXIuaWR9YCxcbiAgICAgICAgbWV0YWRhdGE6IHsgb3JkZXJfaWQ6IG9yZGVyLmlkIH0sXG4gICAgICAgIC8vIFPDvHJlbGkgc3Vic2NyaXB0aW9uIHBhcmFtZXRyZWxlcmlcbiAgICAgICAgc3Vic2NyaXB0aW9uRHVyYXRpb246IGVmZmVjdGl2ZUR1cmF0aW9uLFxuICAgICAgICBwYXltZW50TW9kZTogZWZmZWN0aXZlUGF5bWVudE1vZGUsXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgICAuZnJvbSgnb3JkZXJzJylcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgcHJvdmlkZXJfc2Vzc2lvbl9pZDogc2Vzc2lvbi5zZXNzaW9uSWQsXG4gICAgICAgICAgc3RhdHVzOiAncHJvY2Vzc2luZycsXG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgnaWQnLCBvcmRlci5pZCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBzZXNzaW9uLnNlc3Npb25JZCxcbiAgICAgICAgdXJsOiBzZXNzaW9uLnVybCxcbiAgICAgICAgcHJvdmlkZXI6ICdzdHJpcGUnLFxuICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXG4gICAgICAgIGN1c3RvbWVySWQ6IGN1c3RvbWVyLmlkLFxuICAgICAgICBjdXN0b21lckVtYWlsOiBjdXN0b21lci5lbWFpbCxcbiAgICAgICAgYW1vdW50OiBwcm9kdWN0LnByaWNlLFxuICAgICAgICBjdXJyZW5jeTogcHJvZHVjdC5jdXJyZW5jeSxcbiAgICAgICAgc3VjY2Vzc1VybCxcbiAgICAgICAgY2FuY2VsVXJsLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAocHJvdmlkZXIgPT09ICdwYXl0cicpIHtcbiAgICAgIGlmICghdXNlcklwKSB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgSVAgcmVxdWlyZWQgZm9yIFBheVRSJyk7XG5cbiAgICAgIC8vIFBheVRSIGnDp2luIG1vZGlmaXllIGVkaWxtacWfIHByb2R1Y3QgKHBlxZ9pbiDDtmRlbWUgacOnaW4gZml5YXQgYXlhcmxhbm3EscWfKVxuICAgICAgY29uc3QgcGF5dHJQcm9kdWN0ID0ge1xuICAgICAgICAuLi5wcm9kdWN0LFxuICAgICAgICBwcmljZTogYW1vdW50LCAvLyBjcmVhdGVPcmRlcidkYSBoZXNhcGxhbmFuIHR1dGFyXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3JlYXRlUGF5VFJDaGVja291dFNlc3Npb24oe1xuICAgICAgICBwcm9kdWN0OiBwYXl0clByb2R1Y3QsXG4gICAgICAgIGN1c3RvbWVyOiB7XG4gICAgICAgICAgZW1haWw6IGN1c3RvbWVyLmVtYWlsLFxuICAgICAgICAgIG5hbWU6IGN1c3RvbWVyLm5hbWUgfHwgY3VzdG9tZXIuZW1haWwuc3BsaXQoJ0AnKVswXSxcbiAgICAgICAgICBwaG9uZTogY3VzdG9tZXIucGhvbmUsXG4gICAgICAgICAgYWRkcmVzczogY3VzdG9tZXIuYWRkcmVzcyxcbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJJZDogb3JkZXIuaWQsXG4gICAgICAgIHVzZXJJcCxcbiAgICAgICAgc3VjY2Vzc1VybDogYCR7c3VjY2Vzc1VybH0/b3JkZXJfaWQ9JHtvcmRlci5pZH1gLFxuICAgICAgICBmYWlsVXJsOiBgJHtjYW5jZWxVcmx9P29yZGVyX2lkPSR7b3JkZXIuaWR9YCxcbiAgICAgICAgc3Vic2NyaXB0aW9uRHVyYXRpb246IGVmZmVjdGl2ZUR1cmF0aW9uLFxuICAgICAgICBwYXltZW50TW9kZTogZWZmZWN0aXZlUGF5bWVudE1vZGUsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgIGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgICAuZnJvbSgnb3JkZXJzJylcbiAgICAgICAgICAudXBkYXRlKHsgc3RhdHVzOiAnZmFpbGVkJyB9KVxuICAgICAgICAgIC5lcSgnaWQnLCBvcmRlci5pZCk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdvcmRlcnMnKVxuICAgICAgICAudXBkYXRlKHtcbiAgICAgICAgICBwcm92aWRlcl9zZXNzaW9uX2lkOiBzZXNzaW9uLnRva2VuLFxuICAgICAgICAgIHN0YXR1czogJ3Byb2Nlc3NpbmcnLFxuICAgICAgICB9KVxuICAgICAgICAuZXEoJ2lkJywgb3JkZXIuaWQpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogc2Vzc2lvbi50b2tlbixcbiAgICAgICAgdXJsOiBzZXNzaW9uLmlmcmFtZVVybCxcbiAgICAgICAgcHJvdmlkZXI6ICdwYXl0cicsXG4gICAgICAgIHByb2R1Y3RJZDogcHJvZHVjdC5pZCxcbiAgICAgICAgY3VzdG9tZXJJZDogY3VzdG9tZXIuaWQsXG4gICAgICAgIGN1c3RvbWVyRW1haWw6IGN1c3RvbWVyLmVtYWlsLFxuICAgICAgICBhbW91bnQ6IHByb2R1Y3QucHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBwcm9kdWN0LmN1cnJlbmN5LFxuICAgICAgICBzdWNjZXNzVXJsLFxuICAgICAgICBjYW5jZWxVcmwsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwYXltZW50IHByb3ZpZGVyJyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ29yZGVycycpXG4gICAgICAudXBkYXRlKHsgc3RhdHVzOiAnZmFpbGVkJyB9KVxuICAgICAgLmVxKCdpZCcsIG9yZGVyLmlkKTtcblxuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdmFpbGFibGVQcm92aWRlcnMoKTogUHJvbWlzZTxQYXltZW50UHJvdmlkZXJbXT4ge1xuICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IGdldFBheW1lbnRTZXR0aW5ncygpO1xuICBjb25zdCBwcm92aWRlcnM6IFBheW1lbnRQcm92aWRlcltdID0gW107XG5cbiAgaWYgKHNldHRpbmdzLnN0cmlwZUVuYWJsZWQpIHByb3ZpZGVycy5wdXNoKCdzdHJpcGUnKTtcbiAgaWYgKHNldHRpbmdzLnBheXRyRW5hYmxlZCkgcHJvdmlkZXJzLnB1c2goJ3BheXRyJyk7XG5cbiAgcmV0dXJuIHByb3ZpZGVycztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU9yZGVyU3RhdHVzKFxuICBvcmRlcklkOiBzdHJpbmcsXG4gIHN0YXR1czogT3JkZXJbJ3N0YXR1cyddLFxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB1cGRhdGVEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge1xuICAgIHN0YXR1cyxcbiAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gIH07XG5cbiAgaWYgKG1ldGFkYXRhKSB7XG4gICAgY29uc3QgeyBkYXRhOiBvcmRlciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ29yZGVycycpXG4gICAgICAuc2VsZWN0KCdtZXRhZGF0YScpXG4gICAgICAuZXEoJ2lkJywgb3JkZXJJZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIHVwZGF0ZURhdGEubWV0YWRhdGEgPSB7IC4uLm9yZGVyPy5tZXRhZGF0YSwgLi4ubWV0YWRhdGEgfTtcbiAgfVxuXG4gIGF3YWl0IHN1cGFiYXNlQWRtaW4uZnJvbSgnb3JkZXJzJykudXBkYXRlKHVwZGF0ZURhdGEpLmVxKCdpZCcsIG9yZGVySWQpO1xufVxuIl0sIm5hbWVzIjpbInN1cGFiYXNlQWRtaW4iLCJjcmVhdGVTdHJpcGVDaGVja291dFNlc3Npb24iLCJjcmVhdGVQYXlUUkNoZWNrb3V0U2Vzc2lvbiIsImdldFBheW1lbnRTZXR0aW5ncyIsImRhdGEiLCJmcm9tIiwic2VsZWN0IiwiaW4iLCJzZXR0aW5ncyIsImZvckVhY2giLCJpdGVtIiwia2V5IiwidmFsdWUiLCJkZWZhdWx0UHJvdmlkZXIiLCJkZWZhdWx0X3BheW1lbnRfcHJvdmlkZXIiLCJzdHJpcGVFbmFibGVkIiwic3RyaXBlX2VuYWJsZWQiLCJwYXl0ckVuYWJsZWQiLCJwYXl0cl9lbmFibGVkIiwiYWxsb3dQcm92aWRlclN3aXRjaCIsImFsbG93X3Byb3ZpZGVyX3N3aXRjaCIsImNyZWF0ZU9yZGVyIiwicGFyYW1zIiwicHJvZHVjdElkIiwiY3VzdG9tZXJJZCIsImN1c3RvbWVyRW1haWwiLCJhbW91bnQiLCJjdXJyZW5jeSIsInByb3ZpZGVyIiwibWV0YWRhdGEiLCJzdWJzY3JpcHRpb25EdXJhdGlvbiIsInBheW1lbnRNb2RlIiwiZXJyb3IiLCJpbnNlcnQiLCJwcm9kdWN0X2lkIiwiY3VzdG9tZXJfaWQiLCJjdXN0b21lcl9lbWFpbCIsInN0YXR1cyIsInBheW1lbnRfcHJvdmlkZXIiLCJzdWJzY3JpcHRpb25fZHVyYXRpb24iLCJwYXltZW50X21vZGUiLCJzaW5nbGUiLCJjcmVhdGVDaGVja291dFNlc3Npb24iLCJwcm9kdWN0IiwiY3VzdG9tZXIiLCJ1c2VySXAiLCJzdWNjZXNzVXJsIiwiY2FuY2VsVXJsIiwicHJpY2UiLCJlZmZlY3RpdmVQYXltZW50TW9kZSIsImRlZmF1bHRfcGF5bWVudF9tb2RlIiwiZWZmZWN0aXZlRHVyYXRpb24iLCJ0eXBlIiwib3JkZXIiLCJpZCIsImVtYWlsIiwidW5kZWZpbmVkIiwic2Vzc2lvbiIsIm9yZGVyX2lkIiwidXBkYXRlIiwicHJvdmlkZXJfc2Vzc2lvbl9pZCIsInNlc3Npb25JZCIsImVxIiwidXJsIiwiRXJyb3IiLCJwYXl0clByb2R1Y3QiLCJuYW1lIiwic3BsaXQiLCJwaG9uZSIsImFkZHJlc3MiLCJvcmRlcklkIiwiZmFpbFVybCIsInRva2VuIiwiaWZyYW1lVXJsIiwiZ2V0QXZhaWxhYmxlUHJvdmlkZXJzIiwicHJvdmlkZXJzIiwicHVzaCIsInVwZGF0ZU9yZGVyU3RhdHVzIiwidXBkYXRlRGF0YSIsInVwZGF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/payments.ts\n");

/***/ }),

/***/ "(rsc)/./lib/paytr.ts":
/*!**********************!*\
  !*** ./lib/paytr.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createPayTRCheckoutSession: () => (/* binding */ createPayTRCheckoutSession),\n/* harmony export */   processPayTRCallback: () => (/* binding */ processPayTRCallback),\n/* harmony export */   verifyPayTRCallback: () => (/* binding */ verifyPayTRCallback)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _supabase_admin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./supabase/admin */ \"(rsc)/./lib/supabase/admin.ts\");\n\n\nconst PAYTR_MERCHANT_ID = process.env.PAYTR_MERCHANT_ID;\nconst PAYTR_MERCHANT_KEY = process.env.PAYTR_MERCHANT_KEY;\nconst PAYTR_MERCHANT_SALT = process.env.PAYTR_MERCHANT_SALT;\nconst PAYTR_TEST_MODE = process.env.PAYTR_TEST_MODE === \"true\";\nconst PAYTR_API_URL = \"https://www.paytr.com/odeme/api/get-token\";\nfunction generatePayTRToken(params) {\n    const hashStr = PAYTR_MERCHANT_ID + params.email + params.paymentAmount + params.merchantOid + params.noInstallment + params.maxInstallment + params.currency + params.testMode + PAYTR_MERCHANT_SALT;\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac(\"sha256\", PAYTR_MERCHANT_KEY).update(hashStr).digest(\"base64\");\n}\nasync function createPayTRCheckoutSession(params) {\n    const { product, customer, orderId, userIp, successUrl, failUrl, subscriptionDuration, paymentMode } = params;\n    // PayTR subscription desteklemiyor, bu yüzden toplam tutar hesaplanmış olarak geliyor\n    const paymentAmount = Math.round(product.price * 100);\n    // Ürün adını süre bilgisiyle güncelle\n    let productName = product.name;\n    if (subscriptionDuration && subscriptionDuration > 0) {\n        const period = product.billing_period === \"monthly\" ? \"ay\" : \"yil\";\n        const modeText = paymentMode === \"upfront\" ? \"pesin\" : \"abonelik\";\n        productName = `${product.name} (${subscriptionDuration} ${period} ${modeText})`;\n    }\n    const basketItem = {\n        name: productName,\n        price: (product.price * 100).toFixed(0),\n        quantity: 1\n    };\n    const userBasket = Buffer.from(JSON.stringify([\n        [\n            basketItem.name,\n            basketItem.price,\n            basketItem.quantity\n        ]\n    ])).toString(\"base64\");\n    const currencyMap = {\n        TRY: \"TL\",\n        USD: \"USD\",\n        EUR: \"EUR\"\n    };\n    const currency = currencyMap[product.currency] || \"TL\";\n    const testMode = PAYTR_TEST_MODE ? 1 : 0;\n    const paytrToken = generatePayTRToken({\n        merchantOid: orderId,\n        email: customer.email,\n        paymentAmount,\n        userBasket,\n        noInstallment: 1,\n        maxInstallment: 0,\n        currency,\n        testMode\n    });\n    const formData = new URLSearchParams({\n        merchant_id: PAYTR_MERCHANT_ID,\n        user_ip: userIp,\n        merchant_oid: orderId,\n        email: customer.email,\n        payment_amount: paymentAmount.toString(),\n        paytr_token: paytrToken,\n        user_basket: userBasket,\n        debug_on: \"1\",\n        no_installment: \"1\",\n        max_installment: \"0\",\n        user_name: customer.name,\n        user_address: customer.address || \"Turkiye\",\n        user_phone: customer.phone || \"05000000000\",\n        merchant_ok_url: successUrl,\n        merchant_fail_url: failUrl,\n        timeout_limit: \"30\",\n        currency,\n        test_mode: testMode.toString()\n    });\n    try {\n        const response = await fetch(PAYTR_API_URL, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            body: formData.toString()\n        });\n        const result = await response.json();\n        if (result.status === \"success\" && result.token) {\n            return {\n                token: result.token,\n                iframeUrl: `https://www.paytr.com/odeme/guvenli/${result.token}`\n            };\n        }\n        console.error(\"PayTR token error:\", result.reason);\n        return null;\n    } catch (error) {\n        console.error(\"PayTR API error:\", error);\n        return null;\n    }\n}\nfunction verifyPayTRCallback(params) {\n    const { merchantOid, status, totalAmount, hash } = params;\n    const hashStr = merchantOid + PAYTR_MERCHANT_SALT + status + totalAmount;\n    const expectedHash = crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac(\"sha256\", PAYTR_MERCHANT_KEY).update(hashStr).digest(\"base64\");\n    return hash === expectedHash;\n}\nasync function processPayTRCallback(params) {\n    const { merchantOid, status, totalAmount, hash, failedReasonCode, failedReasonMsg } = params;\n    if (!verifyPayTRCallback({\n        merchantOid,\n        status,\n        totalAmount,\n        hash\n    })) {\n        throw new Error(\"Invalid PayTR hash\");\n    }\n    const isSuccess = status === \"success\";\n    const updateData = {\n        status: isSuccess ? \"completed\" : \"failed\",\n        updated_at: new Date().toISOString()\n    };\n    if (!isSuccess) {\n        updateData.metadata = {\n            paytr_error_code: failedReasonCode,\n            paytr_error_message: failedReasonMsg\n        };\n    }\n    await _supabase_admin__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"orders\").update(updateData).eq(\"id\", merchantOid);\n    return {\n        success: isSuccess,\n        orderId: merchantOid\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxZQUFZZCxXQUFXO0lBRTdCLE1BQU1lLGFBQWtDO1FBQ3RDZixRQUFRYyxZQUFZLGNBQWM7UUFDbENFLFlBQVksSUFBSUMsT0FBT0MsV0FBVztJQUNwQztJQUVBLElBQUksQ0FBQ0osV0FBVztRQUNkQyxXQUFXSSxRQUFRLEdBQUc7WUFDcEJDLGtCQUFrQlQ7WUFDbEJVLHFCQUFxQlQ7UUFDdkI7SUFDRjtJQUVBLE1BQU0zRiwwREFBYUEsQ0FBQzJDLElBQUksQ0FBQyxVQUFVeEIsTUFBTSxDQUFDMkUsWUFBWU8sRUFBRSxDQUFDLE1BQU14RjtJQUUvRCxPQUFPO1FBQUV5RixTQUFTVDtRQUFXckUsU0FBU1g7SUFBWTtBQUNwRCIsInNvdXJjZXMiOlsid2VicGFjazovL21vbmVsaXhhLy4vbGliL3BheXRyLnRzP2VmOTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJy4vc3VwYWJhc2UvYWRtaW4nO1xuaW1wb3J0IHR5cGUgeyBQcm9kdWN0LCBTdWJzY3JpcHRpb25QYXltZW50TW9kZSB9IGZyb20gJ0AvdHlwZXMnO1xuXG5jb25zdCBQQVlUUl9NRVJDSEFOVF9JRCA9IHByb2Nlc3MuZW52LlBBWVRSX01FUkNIQU5UX0lEITtcbmNvbnN0IFBBWVRSX01FUkNIQU5UX0tFWSA9IHByb2Nlc3MuZW52LlBBWVRSX01FUkNIQU5UX0tFWSE7XG5jb25zdCBQQVlUUl9NRVJDSEFOVF9TQUxUID0gcHJvY2Vzcy5lbnYuUEFZVFJfTUVSQ0hBTlRfU0FMVCE7XG5jb25zdCBQQVlUUl9URVNUX01PREUgPSBwcm9jZXNzLmVudi5QQVlUUl9URVNUX01PREUgPT09ICd0cnVlJztcbmNvbnN0IFBBWVRSX0FQSV9VUkwgPSAnaHR0cHM6Ly93d3cucGF5dHIuY29tL29kZW1lL2FwaS9nZXQtdG9rZW4nO1xuXG5pbnRlcmZhY2UgUGF5VFJCYXNrZXRJdGVtIHtcbiAgbmFtZTogc3RyaW5nO1xuICBwcmljZTogc3RyaW5nO1xuICBxdWFudGl0eTogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgUGF5VFJUb2tlblJlc3BvbnNlIHtcbiAgc3RhdHVzOiAnc3VjY2VzcycgfCAnZmFpbGVkJztcbiAgdG9rZW4/OiBzdHJpbmc7XG4gIHJlYXNvbj86IHN0cmluZztcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVQYXlUUlRva2VuKHBhcmFtczoge1xuICBtZXJjaGFudE9pZDogc3RyaW5nO1xuICBlbWFpbDogc3RyaW5nO1xuICBwYXltZW50QW1vdW50OiBudW1iZXI7XG4gIHVzZXJCYXNrZXQ6IHN0cmluZztcbiAgbm9JbnN0YWxsbWVudDogbnVtYmVyO1xuICBtYXhJbnN0YWxsbWVudDogbnVtYmVyO1xuICBjdXJyZW5jeTogc3RyaW5nO1xuICB0ZXN0TW9kZTogbnVtYmVyO1xufSk6IHN0cmluZyB7XG4gIGNvbnN0IGhhc2hTdHIgPVxuICAgIFBBWVRSX01FUkNIQU5UX0lEICtcbiAgICBwYXJhbXMuZW1haWwgK1xuICAgIHBhcmFtcy5wYXltZW50QW1vdW50ICtcbiAgICBwYXJhbXMubWVyY2hhbnRPaWQgK1xuICAgIHBhcmFtcy5ub0luc3RhbGxtZW50ICtcbiAgICBwYXJhbXMubWF4SW5zdGFsbG1lbnQgK1xuICAgIHBhcmFtcy5jdXJyZW5jeSArXG4gICAgcGFyYW1zLnRlc3RNb2RlICtcbiAgICBQQVlUUl9NRVJDSEFOVF9TQUxUO1xuXG4gIHJldHVybiBjcnlwdG9cbiAgICAuY3JlYXRlSG1hYygnc2hhMjU2JywgUEFZVFJfTUVSQ0hBTlRfS0VZKVxuICAgIC51cGRhdGUoaGFzaFN0cilcbiAgICAuZGlnZXN0KCdiYXNlNjQnKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVBheVRSQ2hlY2tvdXRTZXNzaW9uKHBhcmFtczoge1xuICBwcm9kdWN0OiBQcm9kdWN0O1xuICBjdXN0b21lcjoge1xuICAgIGVtYWlsOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHBob25lPzogc3RyaW5nO1xuICAgIGFkZHJlc3M/OiBzdHJpbmc7XG4gIH07XG4gIG9yZGVySWQ6IHN0cmluZztcbiAgdXNlcklwOiBzdHJpbmc7XG4gIHN1Y2Nlc3NVcmw6IHN0cmluZztcbiAgZmFpbFVybDogc3RyaW5nO1xuICAvLyBTw7xyZWxpIHN1YnNjcmlwdGlvbiBpw6dpblxuICBzdWJzY3JpcHRpb25EdXJhdGlvbj86IG51bWJlcjtcbiAgcGF5bWVudE1vZGU/OiBTdWJzY3JpcHRpb25QYXltZW50TW9kZTtcbn0pOiBQcm9taXNlPHsgdG9rZW46IHN0cmluZzsgaWZyYW1lVXJsOiBzdHJpbmcgfSB8IG51bGw+IHtcbiAgY29uc3QgeyBwcm9kdWN0LCBjdXN0b21lciwgb3JkZXJJZCwgdXNlcklwLCBzdWNjZXNzVXJsLCBmYWlsVXJsLCBzdWJzY3JpcHRpb25EdXJhdGlvbiwgcGF5bWVudE1vZGUgfSA9IHBhcmFtcztcblxuICAvLyBQYXlUUiBzdWJzY3JpcHRpb24gZGVzdGVrbGVtaXlvciwgYnUgecO8emRlbiB0b3BsYW0gdHV0YXIgaGVzYXBsYW5txLHFnyBvbGFyYWsgZ2VsaXlvclxuICBjb25zdCBwYXltZW50QW1vdW50ID0gTWF0aC5yb3VuZChwcm9kdWN0LnByaWNlICogMTAwKTtcblxuICAvLyDDnHLDvG4gYWTEsW7EsSBzw7xyZSBiaWxnaXNpeWxlIGfDvG5jZWxsZVxuICBsZXQgcHJvZHVjdE5hbWUgPSBwcm9kdWN0Lm5hbWU7XG4gIGlmIChzdWJzY3JpcHRpb25EdXJhdGlvbiAmJiBzdWJzY3JpcHRpb25EdXJhdGlvbiA+IDApIHtcbiAgICBjb25zdCBwZXJpb2QgPSBwcm9kdWN0LmJpbGxpbmdfcGVyaW9kID09PSAnbW9udGhseScgPyAnYXknIDogJ3lpbCc7XG4gICAgY29uc3QgbW9kZVRleHQgPSBwYXltZW50TW9kZSA9PT0gJ3VwZnJvbnQnID8gJ3Blc2luJyA6ICdhYm9uZWxpayc7XG4gICAgcHJvZHVjdE5hbWUgPSBgJHtwcm9kdWN0Lm5hbWV9ICgke3N1YnNjcmlwdGlvbkR1cmF0aW9ufSAke3BlcmlvZH0gJHttb2RlVGV4dH0pYDtcbiAgfVxuXG4gIGNvbnN0IGJhc2tldEl0ZW06IFBheVRSQmFza2V0SXRlbSA9IHtcbiAgICBuYW1lOiBwcm9kdWN0TmFtZSxcbiAgICBwcmljZTogKHByb2R1Y3QucHJpY2UgKiAxMDApLnRvRml4ZWQoMCksXG4gICAgcXVhbnRpdHk6IDEsXG4gIH07XG5cbiAgY29uc3QgdXNlckJhc2tldCA9IEJ1ZmZlci5mcm9tKFxuICAgIEpTT04uc3RyaW5naWZ5KFtbYmFza2V0SXRlbS5uYW1lLCBiYXNrZXRJdGVtLnByaWNlLCBiYXNrZXRJdGVtLnF1YW50aXR5XV0pXG4gICkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuXG4gIGNvbnN0IGN1cnJlbmN5TWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgIFRSWTogJ1RMJyxcbiAgICBVU0Q6ICdVU0QnLFxuICAgIEVVUjogJ0VVUicsXG4gIH07XG4gIGNvbnN0IGN1cnJlbmN5ID0gY3VycmVuY3lNYXBbcHJvZHVjdC5jdXJyZW5jeV0gfHwgJ1RMJztcbiAgY29uc3QgdGVzdE1vZGUgPSBQQVlUUl9URVNUX01PREUgPyAxIDogMDtcblxuICBjb25zdCBwYXl0clRva2VuID0gZ2VuZXJhdGVQYXlUUlRva2VuKHtcbiAgICBtZXJjaGFudE9pZDogb3JkZXJJZCxcbiAgICBlbWFpbDogY3VzdG9tZXIuZW1haWwsXG4gICAgcGF5bWVudEFtb3VudCxcbiAgICB1c2VyQmFza2V0LFxuICAgIG5vSW5zdGFsbG1lbnQ6IDEsXG4gICAgbWF4SW5zdGFsbG1lbnQ6IDAsXG4gICAgY3VycmVuY3ksXG4gICAgdGVzdE1vZGUsXG4gIH0pO1xuXG4gIGNvbnN0IGZvcm1EYXRhID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgbWVyY2hhbnRfaWQ6IFBBWVRSX01FUkNIQU5UX0lELFxuICAgIHVzZXJfaXA6IHVzZXJJcCxcbiAgICBtZXJjaGFudF9vaWQ6IG9yZGVySWQsXG4gICAgZW1haWw6IGN1c3RvbWVyLmVtYWlsLFxuICAgIHBheW1lbnRfYW1vdW50OiBwYXltZW50QW1vdW50LnRvU3RyaW5nKCksXG4gICAgcGF5dHJfdG9rZW46IHBheXRyVG9rZW4sXG4gICAgdXNlcl9iYXNrZXQ6IHVzZXJCYXNrZXQsXG4gICAgZGVidWdfb246ICcxJyxcbiAgICBub19pbnN0YWxsbWVudDogJzEnLFxuICAgIG1heF9pbnN0YWxsbWVudDogJzAnLFxuICAgIHVzZXJfbmFtZTogY3VzdG9tZXIubmFtZSxcbiAgICB1c2VyX2FkZHJlc3M6IGN1c3RvbWVyLmFkZHJlc3MgfHwgJ1R1cmtpeWUnLFxuICAgIHVzZXJfcGhvbmU6IGN1c3RvbWVyLnBob25lIHx8ICcwNTAwMDAwMDAwMCcsXG4gICAgbWVyY2hhbnRfb2tfdXJsOiBzdWNjZXNzVXJsLFxuICAgIG1lcmNoYW50X2ZhaWxfdXJsOiBmYWlsVXJsLFxuICAgIHRpbWVvdXRfbGltaXQ6ICczMCcsXG4gICAgY3VycmVuY3ksXG4gICAgdGVzdF9tb2RlOiB0ZXN0TW9kZS50b1N0cmluZygpLFxuICB9KTtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goUEFZVFJfQVBJX1VSTCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyxcbiAgICAgIH0sXG4gICAgICBib2R5OiBmb3JtRGF0YS50b1N0cmluZygpLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0OiBQYXlUUlRva2VuUmVzcG9uc2UgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnICYmIHJlc3VsdC50b2tlbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG9rZW46IHJlc3VsdC50b2tlbixcbiAgICAgICAgaWZyYW1lVXJsOiBgaHR0cHM6Ly93d3cucGF5dHIuY29tL29kZW1lL2d1dmVubGkvJHtyZXN1bHQudG9rZW59YCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc29sZS5lcnJvcignUGF5VFIgdG9rZW4gZXJyb3I6JywgcmVzdWx0LnJlYXNvbik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignUGF5VFIgQVBJIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5UGF5VFJDYWxsYmFjayhwYXJhbXM6IHtcbiAgbWVyY2hhbnRPaWQ6IHN0cmluZztcbiAgc3RhdHVzOiBzdHJpbmc7XG4gIHRvdGFsQW1vdW50OiBzdHJpbmc7XG4gIGhhc2g6IHN0cmluZztcbn0pOiBib29sZWFuIHtcbiAgY29uc3QgeyBtZXJjaGFudE9pZCwgc3RhdHVzLCB0b3RhbEFtb3VudCwgaGFzaCB9ID0gcGFyYW1zO1xuXG4gIGNvbnN0IGhhc2hTdHIgPSBtZXJjaGFudE9pZCArIFBBWVRSX01FUkNIQU5UX1NBTFQgKyBzdGF0dXMgKyB0b3RhbEFtb3VudDtcbiAgY29uc3QgZXhwZWN0ZWRIYXNoID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhtYWMoJ3NoYTI1NicsIFBBWVRSX01FUkNIQU5UX0tFWSlcbiAgICAudXBkYXRlKGhhc2hTdHIpXG4gICAgLmRpZ2VzdCgnYmFzZTY0Jyk7XG5cbiAgcmV0dXJuIGhhc2ggPT09IGV4cGVjdGVkSGFzaDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NQYXlUUkNhbGxiYWNrKHBhcmFtczoge1xuICBtZXJjaGFudE9pZDogc3RyaW5nO1xuICBzdGF0dXM6IHN0cmluZztcbiAgdG90YWxBbW91bnQ6IHN0cmluZztcbiAgaGFzaDogc3RyaW5nO1xuICBmYWlsZWRSZWFzb25Db2RlPzogc3RyaW5nO1xuICBmYWlsZWRSZWFzb25Nc2c/OiBzdHJpbmc7XG59KTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IG9yZGVySWQ6IHN0cmluZyB9PiB7XG4gIGNvbnN0IHtcbiAgICBtZXJjaGFudE9pZCxcbiAgICBzdGF0dXMsXG4gICAgdG90YWxBbW91bnQsXG4gICAgaGFzaCxcbiAgICBmYWlsZWRSZWFzb25Db2RlLFxuICAgIGZhaWxlZFJlYXNvbk1zZyxcbiAgfSA9IHBhcmFtcztcblxuICBpZiAoIXZlcmlmeVBheVRSQ2FsbGJhY2soeyBtZXJjaGFudE9pZCwgc3RhdHVzLCB0b3RhbEFtb3VudCwgaGFzaCB9KSkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBQYXlUUiBoYXNoJyk7XG4gIH1cblxuICBjb25zdCBpc1N1Y2Nlc3MgPSBzdGF0dXMgPT09ICdzdWNjZXNzJztcblxuICBjb25zdCB1cGRhdGVEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge1xuICAgIHN0YXR1czogaXNTdWNjZXNzID8gJ2NvbXBsZXRlZCcgOiAnZmFpbGVkJyxcbiAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gIH07XG5cbiAgaWYgKCFpc1N1Y2Nlc3MpIHtcbiAgICB1cGRhdGVEYXRhLm1ldGFkYXRhID0ge1xuICAgICAgcGF5dHJfZXJyb3JfY29kZTogZmFpbGVkUmVhc29uQ29kZSxcbiAgICAgIHBheXRyX2Vycm9yX21lc3NhZ2U6IGZhaWxlZFJlYXNvbk1zZyxcbiAgICB9O1xuICB9XG5cbiAgYXdhaXQgc3VwYWJhc2VBZG1pbi5mcm9tKCdvcmRlcnMnKS51cGRhdGUodXBkYXRlRGF0YSkuZXEoJ2lkJywgbWVyY2hhbnRPaWQpO1xuXG4gIHJldHVybiB7IHN1Y2Nlc3M6IGlzU3VjY2Vzcywgb3JkZXJJZDogbWVyY2hhbnRPaWQgfTtcbn1cbiJdLCJuYW1lcyI6WyJjcnlwdG8iLCJzdXBhYmFzZUFkbWluIiwiUEFZVFJfTUVSQ0hBTlRfSUQiLCJwcm9jZXNzIiwiZW52IiwiUEFZVFJfTUVSQ0hBTlRfS0VZIiwiUEFZVFJfTUVSQ0hBTlRfU0FMVCIsIlBBWVRSX1RFU1RfTU9ERSIsIlBBWVRSX0FQSV9VUkwiLCJnZW5lcmF0ZVBheVRSVG9rZW4iLCJwYXJhbXMiLCJoYXNoU3RyIiwiZW1haWwiLCJwYXltZW50QW1vdW50IiwibWVyY2hhbnRPaWQiLCJub0luc3RhbGxtZW50IiwibWF4SW5zdGFsbG1lbnQiLCJjdXJyZW5jeSIsInRlc3RNb2RlIiwiY3JlYXRlSG1hYyIsInVwZGF0ZSIsImRpZ2VzdCIsImNyZWF0ZVBheVRSQ2hlY2tvdXRTZXNzaW9uIiwicHJvZHVjdCIsImN1c3RvbWVyIiwib3JkZXJJZCIsInVzZXJJcCIsInN1Y2Nlc3NVcmwiLCJmYWlsVXJsIiwic3Vic2NyaXB0aW9uRHVyYXRpb24iLCJwYXltZW50TW9kZSIsIk1hdGgiLCJyb3VuZCIsInByaWNlIiwicHJvZHVjdE5hbWUiLCJuYW1lIiwicGVyaW9kIiwiYmlsbGluZ19wZXJpb2QiLCJtb2RlVGV4dCIsImJhc2tldEl0ZW0iLCJ0b0ZpeGVkIiwicXVhbnRpdHkiLCJ1c2VyQmFza2V0IiwiQnVmZmVyIiwiZnJvbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0b1N0cmluZyIsImN1cnJlbmN5TWFwIiwiVFJZIiwiVVNEIiwiRVVSIiwicGF5dHJUb2tlbiIsImZvcm1EYXRhIiwiVVJMU2VhcmNoUGFyYW1zIiwibWVyY2hhbnRfaWQiLCJ1c2VyX2lwIiwibWVyY2hhbnRfb2lkIiwicGF5bWVudF9hbW91bnQiLCJwYXl0cl90b2tlbiIsInVzZXJfYmFza2V0IiwiZGVidWdfb24iLCJub19pbnN0YWxsbWVudCIsIm1heF9pbnN0YWxsbWVudCIsInVzZXJfbmFtZSIsInVzZXJfYWRkcmVzcyIsImFkZHJlc3MiLCJ1c2VyX3Bob25lIiwicGhvbmUiLCJtZXJjaGFudF9va191cmwiLCJtZXJjaGFudF9mYWlsX3VybCIsInRpbWVvdXRfbGltaXQiLCJ0ZXN0X21vZGUiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJyZXN1bHQiLCJqc29uIiwic3RhdHVzIiwidG9rZW4iLCJpZnJhbWVVcmwiLCJjb25zb2xlIiwiZXJyb3IiLCJyZWFzb24iLCJ2ZXJpZnlQYXlUUkNhbGxiYWNrIiwidG90YWxBbW91bnQiLCJoYXNoIiwiZXhwZWN0ZWRIYXNoIiwicHJvY2Vzc1BheVRSQ2FsbGJhY2siLCJmYWlsZWRSZWFzb25Db2RlIiwiZmFpbGVkUmVhc29uTXNnIiwiRXJyb3IiLCJpc1N1Y2Nlc3MiLCJ1cGRhdGVEYXRhIiwidXBkYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIm1ldGFkYXRhIiwicGF5dHJfZXJyb3JfY29kZSIsInBheXRyX2Vycm9yX21lc3NhZ2UiLCJlcSIsInN1Y2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/paytr.ts\n");

/***/ }),

/***/ "(rsc)/./lib/stripe.ts":
/*!***********************!*\
  !*** ./lib/stripe.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cancelStripeSubscription: () => (/* binding */ cancelStripeSubscription),\n/* harmony export */   createBillingPortalSession: () => (/* binding */ createBillingPortalSession),\n/* harmony export */   createStripeCheckoutSession: () => (/* binding */ createStripeCheckoutSession),\n/* harmony export */   getOrCreateStripeCustomer: () => (/* binding */ getOrCreateStripeCustomer),\n/* harmony export */   getStripeSubscription: () => (/* binding */ getStripeSubscription),\n/* harmony export */   refundStripePayment: () => (/* binding */ refundStripePayment),\n/* harmony export */   resumeStripeSubscription: () => (/* binding */ resumeStripeSubscription),\n/* harmony export */   stripe: () => (/* binding */ stripe),\n/* harmony export */   verifyStripeWebhook: () => (/* binding */ verifyStripeWebhook)\n/* harmony export */ });\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! stripe */ \"(rsc)/./node_modules/stripe/esm/stripe.esm.node.js\");\n/* harmony import */ var _supabase_admin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./supabase/admin */ \"(rsc)/./lib/supabase/admin.ts\");\n\n\nconst stripeSecretKey = process.env.STRIPE_SECRET_KEY;\nconst stripe = new stripe__WEBPACK_IMPORTED_MODULE_0__[\"default\"](stripeSecretKey, {\n    apiVersion: \"2024-12-18.acacia\",\n    typescript: true\n});\nasync function getOrCreateStripeCustomer(customerId, email, name) {\n    const { data: customer } = await _supabase_admin__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"customers\").select(\"stripe_customer_id\").eq(\"id\", customerId).single();\n    if (customer?.stripe_customer_id) {\n        return customer.stripe_customer_id;\n    }\n    const stripeCustomer = await stripe.customers.create({\n        email,\n        name,\n        metadata: {\n            supabase_customer_id: customerId\n        }\n    });\n    await _supabase_admin__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"customers\").update({\n        stripe_customer_id: stripeCustomer.id\n    }).eq(\"id\", customerId);\n    return stripeCustomer.id;\n}\nasync function createStripeCheckoutSession(params) {\n    const { product, customerEmail, customerId, successUrl, cancelUrl, metadata, subscriptionDuration, paymentMode = \"recurring\" } = params;\n    let stripeCustomerId;\n    if (customerId) {\n        stripeCustomerId = await getOrCreateStripeCustomer(customerId, customerEmail);\n    }\n    // Süreli subscription ve ödeme modu belirleme\n    const hasDuration = subscriptionDuration && subscriptionDuration > 0;\n    const isUpfrontPayment = paymentMode === \"upfront\" && hasDuration;\n    // Peşin ödeme durumunda subscription yerine tek seferlik ödeme yapılır\n    // Recurring durumunda subscription oluşturulur ve cancel_at ile bitiş tarihi belirlenir\n    const isSubscriptionMode = product.type === \"subscription\" && !isUpfrontPayment;\n    // Fiyat hesaplama\n    let unitAmount = Math.round(product.price * 100);\n    let quantity = 1;\n    // Peşin ödeme: toplam tutarı hesapla\n    if (isUpfrontPayment && subscriptionDuration) {\n        unitAmount = Math.round(product.price * subscriptionDuration * 100);\n    }\n    // Abonelik bitiş tarihi hesaplama\n    let cancelAt;\n    if (isSubscriptionMode && hasDuration) {\n        const now = new Date();\n        if (product.billing_period === \"yearly\") {\n            now.setFullYear(now.getFullYear() + subscriptionDuration);\n        } else {\n            now.setMonth(now.getMonth() + subscriptionDuration);\n        }\n        cancelAt = Math.floor(now.getTime() / 1000);\n    }\n    const session = await stripe.checkout.sessions.create({\n        mode: isSubscriptionMode ? \"subscription\" : \"payment\",\n        customer: stripeCustomerId,\n        customer_email: stripeCustomerId ? undefined : customerEmail,\n        line_items: [\n            {\n                price_data: {\n                    currency: product.currency.toLowerCase(),\n                    product_data: {\n                        name: product.name,\n                        description: isUpfrontPayment && subscriptionDuration ? `${product.description || \"\"} (${subscriptionDuration} ${product.billing_period === \"monthly\" ? \"ay\" : \"yil\"} pesin)`.trim() : product.description || undefined,\n                        images: product.image_url ? [\n                            product.image_url\n                        ] : undefined\n                    },\n                    unit_amount: unitAmount,\n                    recurring: isSubscriptionMode ? {\n                        interval: product.billing_period === \"yearly\" ? \"year\" : \"month\"\n                    } : undefined\n                },\n                quantity\n            }\n        ],\n        success_url: `${successUrl}?session_id={CHECKOUT_SESSION_ID}`,\n        cancel_url: cancelUrl,\n        metadata: {\n            product_id: product.id,\n            customer_id: customerId || \"\",\n            subscription_duration: subscriptionDuration?.toString() || \"\",\n            payment_mode: paymentMode,\n            ...metadata\n        },\n        payment_intent_data: !isSubscriptionMode ? {\n            metadata: {\n                product_id: product.id,\n                customer_id: customerId || \"\",\n                subscription_duration: subscriptionDuration?.toString() || \"\",\n                payment_mode: paymentMode\n            }\n        } : undefined,\n        subscription_data: isSubscriptionMode ? {\n            metadata: {\n                product_id: product.id,\n                customer_id: customerId || \"\",\n                subscription_duration: subscriptionDuration?.toString() || \"\",\n                payment_mode: paymentMode\n            },\n            // Süreli subscription için bitiş tarihi\n            ...cancelAt ? {\n                cancel_at: cancelAt\n            } : {}\n        } : undefined\n    });\n    return {\n        sessionId: session.id,\n        url: session.url\n    };\n}\nasync function createBillingPortalSession(stripeCustomerId, returnUrl) {\n    const session = await stripe.billingPortal.sessions.create({\n        customer: stripeCustomerId,\n        return_url: returnUrl\n    });\n    return session.url;\n}\nasync function cancelStripeSubscription(stripeSubscriptionId, immediate = false) {\n    if (immediate) {\n        return await stripe.subscriptions.cancel(stripeSubscriptionId);\n    }\n    return await stripe.subscriptions.update(stripeSubscriptionId, {\n        cancel_at_period_end: true\n    });\n}\nasync function resumeStripeSubscription(stripeSubscriptionId) {\n    return await stripe.subscriptions.update(stripeSubscriptionId, {\n        cancel_at_period_end: false\n    });\n}\nasync function getStripeSubscription(stripeSubscriptionId) {\n    return await stripe.subscriptions.retrieve(stripeSubscriptionId);\n}\nasync function refundStripePayment(paymentIntentId, amount) {\n    return await stripe.refunds.create({\n        payment_intent: paymentIntentId,\n        amount: amount ? Math.round(amount * 100) : undefined\n    });\n}\nfunction verifyStripeWebhook(payload, signature) {\n    const webhookSecret = process.env.STRIPE_WEBHOOK_SECRET;\n    return stripe.webhooks.constructEvent(payload, signature, webhookSecret);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bnQiOlsiaW1wb3J0IFN0cmlwZSBmcm9tICdzdHJpcGUnO1xuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJy4vc3VwYWJhc2UvYWRtaW4nO1xuaW1wb3J0IHR5cGUgeyBQcm9kdWN0LCBTdWJzY3JpcHRpb25QYXltZW50TW9kZSB9IGZyb20gJ0AvdHlwZXMnO1xuXG5jb25zdCBzdHJpcGVTZWNyZXRLZXkgPSBwcm9jZXNzLmVudi5TVFJJUEVfU0VDUkVUX0tFWSE7XG5cbmV4cG9ydCBjb25zdCBzdHJpcGUgPSBuZXcgU3RyaXBlKHN0cmlwZVNlY3JldEtleSwge1xuICBhcGlWZXJzaW9uOiAnMjAyNC0xMi0xOC5hY2FjaWEnLFxuICB0eXBlc2NyaXB0OiB0cnVlLFxufSk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPckNyZWF0ZVN0cmlwZUN1c3RvbWVyKFxuICBjdXN0b21lcklkOiBzdHJpbmcsXG4gIGVtYWlsOiBzdHJpbmcsXG4gIG5hbWU/OiBzdHJpbmdcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHsgZGF0YTogY3VzdG9tZXIgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAuZnJvbSgnY3VzdG9tZXJzJylcbiAgICAuc2VsZWN0KCdzdHJpcGVfY3VzdG9tZXJfaWQnKVxuICAgIC5lcSgnaWQnLCBjdXN0b21lcklkKVxuICAgIC5zaW5nbGUoKTtcblxuICBpZiAoY3VzdG9tZXI/LnN0cmlwZV9jdXN0b21lcl9pZCkge1xuICAgIHJldHVybiBjdXN0b21lci5zdHJpcGVfY3VzdG9tZXJfaWQ7XG4gIH1cblxuICBjb25zdCBzdHJpcGVDdXN0b21lciA9IGF3YWl0IHN0cmlwZS5jdXN0b21lcnMuY3JlYXRlKHtcbiAgICBlbWFpbCxcbiAgICBuYW1lLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBzdXBhYmFzZV9jdXN0b21lcl9pZDogY3VzdG9tZXJJZCxcbiAgICB9LFxuICB9KTtcblxuICBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oJ2N1c3RvbWVycycpXG4gICAgLnVwZGF0ZSh7IHN0cmlwZV9jdXN0b21lcl9pZDogc3RyaXBlQ3VzdG9tZXIuaWQgfSlcbiAgICAuZXEoJ2lkJywgY3VzdG9tZXJJZCk7XG5cbiAgcmV0dXJuIHN0cmlwZUN1c3RvbWVyLmlkO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlU3RyaXBlQ2hlY2tvdXRTZXNzaW9uKHBhcmFtczoge1xuICBwcm9kdWN0OiBQcm9kdWN0O1xuICBjdXN0b21lckVtYWlsOiBzdHJpbmc7XG4gIGN1c3RvbWVySWQ/OiBzdHJpbmc7XG4gIHN1Y2Nlc3NVcmw6IHN0cmluZztcbiAgY2FuY2VsVXJsOiBzdHJpbmc7XG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgLy8gU8O8cmVsaSBzdWJzY3JpcHRpb24gcGFyYW1ldHJlbGVyaVxuICBzdWJzY3JpcHRpb25EdXJhdGlvbj86IG51bWJlcjtcbiAgcGF5bWVudE1vZGU/OiBTdWJzY3JpcHRpb25QYXltZW50TW9kZTtcbn0pOiBQcm9taXNlPHsgc2Vzc2lvbklkOiBzdHJpbmc7IHVybDogc3RyaW5nIH0+IHtcbiAgY29uc3Qge1xuICAgIHByb2R1Y3QsXG4gICAgY3VzdG9tZXJFbWFpbCxcbiAgICBjdXN0b21lcklkLFxuICAgIHN1Y2Nlc3NVcmwsXG4gICAgY2FuY2VsVXJsLFxuICAgIG1ldGFkYXRhLFxuICAgIHN1YnNjcmlwdGlvbkR1cmF0aW9uLFxuICAgIHBheW1lbnRNb2RlID0gJ3JlY3VycmluZycsXG4gIH0gPSBwYXJhbXM7XG5cbiAgbGV0IHN0cmlwZUN1c3RvbWVySWQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgaWYgKGN1c3RvbWVySWQpIHtcbiAgICBzdHJpcGVDdXN0b21lcklkID0gYXdhaXQgZ2V0T3JDcmVhdGVTdHJpcGVDdXN0b21lcihcbiAgICAgIGN1c3RvbWVySWQsXG4gICAgICBjdXN0b21lckVtYWlsXG4gICAgKTtcbiAgfVxuXG4gIC8vIFPDvHJlbGkgc3Vic2NyaXB0aW9uIHZlIMO2ZGVtZSBtb2R1IGJlbGlybGVtZVxuICBjb25zdCBoYXNEdXJhdGlvbiA9IHN1YnNjcmlwdGlvbkR1cmF0aW9uICYmIHN1YnNjcmlwdGlvbkR1cmF0aW9uID4gMDtcbiAgY29uc3QgaXNVcGZyb250UGF5bWVudCA9IHBheW1lbnRNb2RlID09PSAndXBmcm9udCcgJiYgaGFzRHVyYXRpb247XG5cbiAgLy8gUGXFn2luIMO2ZGVtZSBkdXJ1bXVuZGEgc3Vic2NyaXB0aW9uIHllcmluZSB0ZWsgc2VmZXJsaWsgw7ZkZW1lIHlhcMSxbMSxclxuICAvLyBSZWN1cnJpbmcgZHVydW11bmRhIHN1YnNjcmlwdGlvbiBvbHXFn3R1cnVsdXIgdmUgY2FuY2VsX2F0IGlsZSBiaXRpxZ8gdGFyaWhpIGJlbGlybGVuaXJcbiAgY29uc3QgaXNTdWJzY3JpcHRpb25Nb2RlID0gcHJvZHVjdC50eXBlID09PSAnc3Vic2NyaXB0aW9uJyAmJiAhaXNVcGZyb250UGF5bWVudDtcblxuICAvLyBGaXlhdCBoZXNhcGxhbWFcbiAgbGV0IHVuaXRBbW91bnQgPSBNYXRoLnJvdW5kKHByb2R1Y3QucHJpY2UgKiAxMDApO1xuICBsZXQgcXVhbnRpdHkgPSAxO1xuXG4gIC8vIFBlxZ9pbiDDtmRlbWU6IHRvcGxhbSB0dXRhcsSxIGhlc2FwbGFcbiAgaWYgKGlzVXBmcm9udFBheW1lbnQgJiYgc3Vic2NyaXB0aW9uRHVyYXRpb24pIHtcbiAgICB1bml0QW1vdW50ID0gTWF0aC5yb3VuZChwcm9kdWN0LnByaWNlICogc3Vic2NyaXB0aW9uRHVyYXRpb24gKiAxMDApO1xuICB9XG5cbiAgLy8gQWJvbmVsaWsgYml0acWfIHRhcmloaSBoZXNhcGxhbWFcbiAgbGV0IGNhbmNlbEF0OiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gIGlmIChpc1N1YnNjcmlwdGlvbk1vZGUgJiYgaGFzRHVyYXRpb24pIHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGlmIChwcm9kdWN0LmJpbGxpbmdfcGVyaW9kID09PSAneWVhcmx5Jykge1xuICAgICAgbm93LnNldEZ1bGxZZWFyKG5vdy5nZXRGdWxsWWVhcigpICsgc3Vic2NyaXB0aW9uRHVyYXRpb24hKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbm93LnNldE1vbnRoKG5vdy5nZXRNb250aCgpICsgc3Vic2NyaXB0aW9uRHVyYXRpb24hKTtcbiAgICB9XG4gICAgY2FuY2VsQXQgPSBNYXRoLmZsb29yKG5vdy5nZXRUaW1lKCkgLyAxMDAwKTtcbiAgfVxuXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBzdHJpcGUuY2hlY2tvdXQuc2Vzc2lvbnMuY3JlYXRlKHtcbiAgICBtb2RlOiBpc1N1YnNjcmlwdGlvbk1vZGUgPyAnc3Vic2NyaXB0aW9uJyA6ICdwYXltZW50JyxcbiAgICBjdXN0b21lcjogc3RyaXBlQ3VzdG9tZXJJZCxcbiAgICBjdXN0b21lcl9lbWFpbDogc3RyaXBlQ3VzdG9tZXJJZCA/IHVuZGVmaW5lZCA6IGN1c3RvbWVyRW1haWwsXG4gICAgbGluZV9pdGVtczogW1xuICAgICAge1xuICAgICAgICBwcmljZV9kYXRhOiB7XG4gICAgICAgICAgY3VycmVuY3k6IHByb2R1Y3QuY3VycmVuY3kudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICBwcm9kdWN0X2RhdGE6IHtcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBpc1VwZnJvbnRQYXltZW50ICYmIHN1YnNjcmlwdGlvbkR1cmF0aW9uXG4gICAgICAgICAgICAgID8gYCR7cHJvZHVjdC5kZXNjcmlwdGlvbiB8fCAnJ30gKCR7c3Vic2NyaXB0aW9uRHVyYXRpb259ICR7cHJvZHVjdC5iaWxsaW5nX3BlcmlvZCA9PT0gJ21vbnRobHknID8gJ2F5JyA6ICd5aWwnfSBwZXNpbilgLnRyaW0oKVxuICAgICAgICAgICAgICA6IHByb2R1Y3QuZGVzY3JpcHRpb24gfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgaW1hZ2VzOiBwcm9kdWN0LmltYWdlX3VybCA/IFtwcm9kdWN0LmltYWdlX3VybF0gOiB1bmRlZmluZWQsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB1bml0X2Ftb3VudDogdW5pdEFtb3VudCxcbiAgICAgICAgICByZWN1cnJpbmc6IGlzU3Vic2NyaXB0aW9uTW9kZVxuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgaW50ZXJ2YWw6IHByb2R1Y3QuYmlsbGluZ19wZXJpb2QgPT09ICd5ZWFybHknID8gJ3llYXInIDogJ21vbnRoJyxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgIH0sXG4gICAgICAgIHF1YW50aXR5LFxuICAgICAgfSxcbiAgICBdLFxuICAgIHN1Y2Nlc3NfdXJsOiBgJHtzdWNjZXNzVXJsfT9zZXNzaW9uX2lkPXtDSEVDS09VVF9TRVNTSU9OX0lEfWAsXG4gICAgY2FuY2VsX3VybDogY2FuY2VsVXJsLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBwcm9kdWN0X2lkOiBwcm9kdWN0LmlkLFxuICAgICAgY3VzdG9tZXJfaWQ6IGN1c3RvbWVySWQgfHwgJycsXG4gICAgICBzdWJzY3JpcHRpb25fZHVyYXRpb246IHN1YnNjcmlwdGlvbkR1cmF0aW9uPy50b1N0cmluZygpIHx8ICcnLFxuICAgICAgcGF5bWVudF9tb2RlOiBwYXltZW50TW9kZSxcbiAgICAgIC4uLm1ldGFkYXRhLFxuICAgIH0sXG4gICAgcGF5bWVudF9pbnRlbnRfZGF0YTogIWlzU3Vic2NyaXB0aW9uTW9kZVxuICAgICAgPyB7XG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIHByb2R1Y3RfaWQ6IHByb2R1Y3QuaWQsXG4gICAgICAgICAgICBjdXN0b21lcl9pZDogY3VzdG9tZXJJZCB8fCAnJyxcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbl9kdXJhdGlvbjogc3Vic2NyaXB0aW9uRHVyYXRpb24/LnRvU3RyaW5nKCkgfHwgJycsXG4gICAgICAgICAgICBwYXltZW50X21vZGU6IHBheW1lbnRNb2RlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIDogdW5kZWZpbmVkLFxuICAgIHN1YnNjcmlwdGlvbl9kYXRhOiBpc1N1YnNjcmlwdGlvbk1vZGVcbiAgICAgID8ge1xuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBwcm9kdWN0X2lkOiBwcm9kdWN0LmlkLFxuICAgICAgICAgICAgY3VzdG9tZXJfaWQ6IGN1c3RvbWVySWQgfHwgJycsXG4gICAgICAgICAgICBzdWJzY3JpcHRpb25fZHVyYXRpb246IHN1YnNjcmlwdGlvbkR1cmF0aW9uPy50b1N0cmluZygpIHx8ICcnLFxuICAgICAgICAgICAgcGF5bWVudF9tb2RlOiBwYXltZW50TW9kZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIC8vIFPDvHJlbGkgc3Vic2NyaXB0aW9uIGnDp2luIGJpdGnFnyB0YXJpaGlcbiAgICAgICAgICAuLi4oY2FuY2VsQXQgPyB7IGNhbmNlbF9hdDogY2FuY2VsQXQgfSA6IHt9KSxcbiAgICAgICAgfVxuICAgICAgOiB1bmRlZmluZWQsXG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgc2Vzc2lvbklkOiBzZXNzaW9uLmlkLFxuICAgIHVybDogc2Vzc2lvbi51cmwhLFxuICB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQmlsbGluZ1BvcnRhbFNlc3Npb24oXG4gIHN0cmlwZUN1c3RvbWVySWQ6IHN0cmluZyxcbiAgcmV0dXJuVXJsOiBzdHJpbmdcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBzdHJpcGUuYmlsbGluZ1BvcnRhbC5zZXNzaW9ucy5jcmVhdGUoe1xuICAgIGN1c3RvbWVyOiBzdHJpcGVDdXN0b21lcklkLFxuICAgIHJldHVybl91cmw6IHJldHVyblVybCxcbiAgfSk7XG5cbiAgcmV0dXJuIHNlc3Npb24udXJsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FuY2VsU3RyaXBlU3Vic2NyaXB0aW9uKFxuICBzdHJpcGVTdWJzY3JpcHRpb25JZDogc3RyaW5nLFxuICBpbW1lZGlhdGU6IGJvb2xlYW4gPSBmYWxzZVxuKTogUHJvbWlzZTxTdHJpcGUuU3Vic2NyaXB0aW9uPiB7XG4gIGlmIChpbW1lZGlhdGUpIHtcbiAgICByZXR1cm4gYXdhaXQgc3RyaXBlLnN1YnNjcmlwdGlvbnMuY2FuY2VsKHN0cmlwZVN1YnNjcmlwdGlvbklkKTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBzdHJpcGUuc3Vic2NyaXB0aW9ucy51cGRhdGUoc3RyaXBlU3Vic2NyaXB0aW9uSWQsIHtcbiAgICBjYW5jZWxfYXRfcGVyaW9kX2VuZDogdHJ1ZSxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXN1bWVTdHJpcGVTdWJzY3JpcHRpb24oXG4gIHN0cmlwZVN1YnNjcmlwdGlvbklkOiBzdHJpbmdcbik6IFByb21pc2U8U3RyaXBlLlN1YnNjcmlwdGlvbj4ge1xuICByZXR1cm4gYXdhaXQgc3RyaXBlLnN1YnNjcmlwdGlvbnMudXBkYXRlKHN0cmlwZVN1YnNjcmlwdGlvbklkLCB7XG4gICAgY2FuY2VsX2F0X3BlcmlvZF9lbmQ6IGZhbHNlLFxuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0cmlwZVN1YnNjcmlwdGlvbihcbiAgc3RyaXBlU3Vic2NyaXB0aW9uSWQ6IHN0cmluZ1xuKTogUHJvbWlzZTxTdHJpcGUuU3Vic2NyaXB0aW9uPiB7XG4gIHJldHVybiBhd2FpdCBzdHJpcGUuc3Vic2NyaXB0aW9ucy5yZXRyaWV2ZShzdHJpcGVTdWJzY3JpcHRpb25JZCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWZ1bmRTdHJpcGVQYXltZW50KFxuICBwYXltZW50SW50ZW50SWQ6IHN0cmluZyxcbiAgYW1vdW50PzogbnVtYmVyXG4pOiBQcm9taXNlPFN0cmlwZS5SZWZ1bmQ+IHtcbiAgcmV0dXJuIGF3YWl0IHN0cmlwZS5yZWZ1bmRzLmNyZWF0ZSh7XG4gICAgcGF5bWVudF9pbnRlbnQ6IHBheW1lbnRJbnRlbnRJZCxcbiAgICBhbW91bnQ6IGFtb3VudCA/IE1hdGgucm91bmQoYW1vdW50ICogMTAwKSA6IHVuZGVmaW5lZCxcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlTdHJpcGVXZWJob29rKFxuICBwYXlsb2FkOiBzdHJpbmcgfCBCdWZmZXIsXG4gIHNpZ25hdHVyZTogc3RyaW5nXG4pOiBTdHJpcGUuRXZlbnQge1xuICBjb25zdCB3ZWJob29rU2VjcmV0ID0gcHJvY2Vzcy5lbnYuU1RSSVBFX1dFQkhPT0tfU0VDUkVUITtcbiAgcmV0dXJuIHN0cmlwZS53ZWJob29rcy5jb25zdHJ1Y3RFdmVudChwYXlsb2FkLCBzaWduYXR1cmUsIHdlYmhvb2tTZWNyZXQpO1xufVxuIl0sIm5hbWVzIjpbIlN0cmlwZSIsInN1cGFiYXNlQWRtaW4iLCJzdHJpcGVTZWNyZXRLZXkiLCJwcm9jZXNzIiwiZW52IiwiU1RSSVBFX1NFQ1JFVF9LRVkiLCJzdHJpcGUiLCJhcGlWZXJzaW9uIiwidHlwZXNjcmlwdCIsImdldE9yQ3JlYXRlU3RyaXBlQ3VzdG9tZXIiLCJjdXN0b21lcklkIiwiZW1haWwiLCJuYW1lIiwiZGF0YSIsImN1c3RvbWVyIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwic3RyaXBlX2N1c3RvbWVyX2lkIiwic3RyaXBlQ3VzdG9tZXIiLCJjdXN0b21lcnMiLCJjcmVhdGUiLCJtZXRhZGF0YSIsInN1cGFiYXNlX2N1c3RvbWVyX2lkIiwidXBkYXRlIiwiaWQiLCJjcmVhdGVTdHJpcGVDaGVja291dFNlc3Npb24iLCJwYXJhbXMiLCJwcm9kdWN0IiwiY3VzdG9tZXJFbWFpbCIsInN1Y2Nlc3NVcmwiLCJjYW5jZWxVcmwiLCJzdWJzY3JpcHRpb25EdXJhdGlvbiIsInBheW1lbnRNb2RlIiwic3RyaXBlQ3VzdG9tZXJJZCIsImhhc0R1cmF0aW9uIiwiaXNVcGZyb250UGF5bWVudCIsImlzU3Vic2NyaXB0aW9uTW9kZSIsInR5cGUiLCJ1bml0QW1vdW50IiwiTWF0aCIsInJvdW5kIiwicHJpY2UiLCJxdWFudGl0eSIsImNhbmNlbEF0Iiwibm93IiwiRGF0ZSIsImJpbGxpbmdfcGVyaW9kIiwic2V0RnVsbFllYXIiLCJnZXRGdWxsWWVhciIsInNldE1vbnRoIiwiZ2V0TW9udGgiLCJmbG9vciIsImdldFRpbWUiLCJzZXNzaW9uIiwiY2hlY2tvdXQiLCJzZXNzaW9ucyIsIm1vZGUiLCJjdXN0b21lcl9lbWFpbCIsInVuZGVmaW5lZCIsImxpbmVfaXRlbXMiLCJwcmljZV9kYXRhIiwiY3VycmVuY3kiLCJ0b0xvd2VyQ2FzZSIsInByb2R1Y3RfZGF0YSIsImRlc2NyaXB0aW9uIiwidHJpbSIsImltYWdlcyIsImltYWdlX3VybCIsInVuaXRfYW1vdW50IiwicmVjdXJyaW5nIiwiaW50ZXJ2YWwiLCJzdWNjZXNzX3VybCIsImNhbmNlbF91cmwiLCJwcm9kdWN0X2lkIiwiY3VzdG9tZXJfaWQiLCJzdWJzY3JpcHRpb25fZHVyYXRpb24iLCJ0b1N0cmluZyIsInBheW1lbnRfbW9kZSIsInBheW1lbnRfaW50ZW50X2RhdGEiLCJzdWJzY3JpcHRpb25fZGF0YSIsImNhbmNlbF9hdCIsInNlc3Npb25JZCIsInVybCIsImNyZWF0ZUJpbGxpbmdQb3J0YWxTZXNzaW9uIiwicmV0dXJuVXJsIiwiYmlsbGluZ1BvcnRhbCIsInJldHVybl91cmwiLCJjYW5jZWxTdHJpcGVTdWJzY3JpcHRpb24iLCJzdHJpcGVTdWJzY3JpcHRpb25JZCIsImltbWVkaWF0ZSIsInN1YnNjcmlwdGlvbnMiLCJjYW5jZWwiLCJjYW5jZWxfYXRfcGVyaW9kX2VuZCIsInJlc3VtZVN0cmlwZVN1YnNjcmlwdGlvbiIsImdldFN0cmlwZVN1YnNjcmlwdGlvbiIsInJldHJpZXZlIiwicmVmdW5kU3RyaXBlUGF5bWVudCIsInBheW1lbnRJbnRlbnRJZCIsImFtb3VudCIsInJlZnVuZHMiLCJwYXltZW50X2ludGVudCIsInZlcmlmeVN0cmlwZVdlYmhvb2siLCJwYXlsb2FkIiwic2lnbmF0dXJlIiwid2ViaG9va1NlY3JldCIsIlNUUklQRV9XRUJIT09LX1NFQ1JFVCIsIndlYmhvb2tzIiwiY29uc3RydWN0RXZlbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/stripe.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/admin.ts":
/*!*******************************!*\
  !*** ./lib/supabase/admin.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAuditLog: () => (/* binding */ createAuditLog),\n/* harmony export */   getSetting: () => (/* binding */ getSetting),\n/* harmony export */   getSettings: () => (/* binding */ getSettings),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin),\n/* harmony export */   updateSetting: () => (/* binding */ updateSetting)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://cxmiphavaltkeyobaptg.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n    auth: {\n        autoRefreshToken: false,\n        persistSession: false\n    }\n});\nasync function getSettings() {\n    const { data, error } = await supabaseAdmin.from(\"settings\").select(\"key, value\");\n    if (error) {\n        console.error(\"Error fetching settings:\", error);\n        return {};\n    }\n    return data.reduce((acc, item)=>{\n        acc[item.key] = item.value || \"\";\n        return acc;\n    }, {});\n}\nasync function getSetting(key) {\n    const { data, error } = await supabaseAdmin.from(\"settings\").select(\"value\").eq(\"key\", key).single();\n    if (error) return null;\n    return data?.value || null;\n}\nasync function updateSetting(key, value) {\n    const { error } = await supabaseAdmin.from(\"settings\").update({\n        value\n    }).eq(\"key\", key);\n    return !error;\n}\nasync function createAuditLog(params) {\n    const oldValue = params.oldValue ?? params.oldValues;\n    const newValue = params.newValue ?? params.newValues;\n    const { error } = await supabaseAdmin.from(\"audit_logs\").insert({\n        admin_id: params.adminId,\n        action: params.action,\n        entity_type: params.entityType,\n        entity_id: params.entityId,\n        old_value: oldValue,\n        new_value: newValue,\n        ip_address: params.ipAddress,\n        user_agent: params.userAgent\n    });\n    if (error) {\n        console.error(\"Error creating audit log:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2UvYWRtaW4udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXFEO0FBRzlDLE1BQU1DLGdCQUFnQkQsbUVBQVlBLENBQ3ZDRSwwQ0FBb0MsRUFDcENBLFFBQVFDLEdBQUcsQ0FBQ0UseUJBQXlCLEVBQ3JDO0lBQ0VDLE1BQU07UUFDSkMsa0JBQWtCO1FBQ2xCQyxnQkFBZ0I7SUFDbEI7QUFDRixHQUNBO0FBRUssZUFBZUM7SUFDcEIsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1WLGNBQzNCVyxJQUFJLENBQUMsWUFDTEMsTUFBTSxDQUFDO0lBRVYsSUFBSUYsT0FBTztRQUNURyxRQUFRSCxLQUFLLENBQUMsNEJBQTRCQTtRQUMxQyxPQUFPLENBQUM7SUFDVjtJQUVBLE9BQU9ELEtBQUtLLE1BQU0sQ0FBQyxDQUFDQyxLQUFLQztRQUN2QkQsR0FBRyxDQUFDQyxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsS0FBSyxJQUFJO1FBQzlCLE9BQU9IO0lBQ1QsR0FBRyxDQUFDO0FBQ047QUFFTyxlQUFlSSxXQUFXRixHQUFXO0lBQzFDLE1BQU0sRUFBRVIsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNVixjQUMzQlcsSUFBSSxDQUFDLFlBQ0xDLE1BQU0sQ0FBQyxTQUNQUSxFQUFFLENBQUMsT0FBT0gsS0FDVkksTUFBTTtJQUVULElBQUlYLE9BQU8sT0FBTztJQUNsQixPQUFPRCxNQUFNUyxTQUFTO0FBQ3hCO0FBRU8sZUFBZUksY0FBY0wsR0FBVyxFQUFFQyxLQUFhO0lBQzVELE1BQU0sRUFBRVIsS0FBSyxFQUFFLEdBQUcsTUFBTVYsY0FDckJXLElBQUksQ0FBQyxZQUNMWSxNQUFNLENBQUM7UUFBRUw7SUFBTSxHQUNmRSxFQUFFLENBQUMsT0FBT0g7SUFFYixPQUFPLENBQUNQO0FBQ1Y7QUFFTyxlQUFlYyxlQUFlQyxNQVdwQztJQUNDLE1BQU1DLFdBQVdELE9BQU9DLFFBQVEsSUFBSUQsT0FBT0UsU0FBUztJQUNwRCxNQUFNQyxXQUFXSCxPQUFPRyxRQUFRLElBQUlILE9BQU9JLFNBQVM7SUFDcEQsTUFBTSxFQUFFbkIsS0FBSyxFQUFFLEdBQUcsTUFBTVYsY0FBY1csSUFBSSxDQUFDLGNBQWNtQixNQUFNLENBQUM7UUFDOURDLFVBQVVOLE9BQU9PLE9BQU87UUFDeEJDLFFBQVFSLE9BQU9RLE1BQU07UUFDckJDLGFBQWFULE9BQU9VLFVBQVU7UUFDOUJDLFdBQVdYLE9BQU9ZLFFBQVE7UUFDMUJDLFdBQVdaO1FBQ1hhLFdBQVdYO1FBQ1hZLFlBQVlmLE9BQU9nQixTQUFTO1FBQzVCQyxZQUFZakIsT0FBT2tCLFNBQVM7SUFDOUI7SUFFQSxJQUFJakMsT0FBTztRQUNURyxRQUFRSCxLQUFLLENBQUMsNkJBQTZCQTtJQUM3QztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbW9uZWxpeGEvLi9saWIvc3VwYWJhc2UvYWRtaW4udHM/ODE2YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xyXG5pbXBvcnQgdHlwZSB7IFNldHRpbmdzTWFwIH0gZnJvbSAnQC90eXBlcyc7XHJcblxyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IGNyZWF0ZUNsaWVudChcclxuICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxyXG4gIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkhLFxyXG4gIHtcclxuICAgIGF1dGg6IHtcclxuICAgICAgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UsXHJcbiAgICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZSxcclxuICAgIH0sXHJcbiAgfVxyXG4pO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNldHRpbmdzKCk6IFByb21pc2U8U2V0dGluZ3NNYXA+IHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXHJcbiAgICAuZnJvbSgnc2V0dGluZ3MnKVxyXG4gICAgLnNlbGVjdCgna2V5LCB2YWx1ZScpO1xyXG5cclxuICBpZiAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHNldHRpbmdzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7fTtcclxuICB9XHJcblxyXG4gIHJldHVybiBkYXRhLnJlZHVjZSgoYWNjLCBpdGVtKSA9PiB7XHJcbiAgICBhY2NbaXRlbS5rZXldID0gaXRlbS52YWx1ZSB8fCAnJztcclxuICAgIHJldHVybiBhY2M7XHJcbiAgfSwge30gYXMgU2V0dGluZ3NNYXApO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2V0dGluZyhrZXk6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xyXG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cclxuICAgIC5mcm9tKCdzZXR0aW5ncycpXHJcbiAgICAuc2VsZWN0KCd2YWx1ZScpXHJcbiAgICAuZXEoJ2tleScsIGtleSlcclxuICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgaWYgKGVycm9yKSByZXR1cm4gbnVsbDtcclxuICByZXR1cm4gZGF0YT8udmFsdWUgfHwgbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVNldHRpbmcoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXHJcbiAgICAuZnJvbSgnc2V0dGluZ3MnKVxyXG4gICAgLnVwZGF0ZSh7IHZhbHVlIH0pXHJcbiAgICAuZXEoJ2tleScsIGtleSk7XHJcblxyXG4gIHJldHVybiAhZXJyb3I7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVBdWRpdExvZyhwYXJhbXM6IHtcclxuICBhZG1pbklkOiBzdHJpbmc7XHJcbiAgYWN0aW9uOiBzdHJpbmc7XHJcbiAgZW50aXR5VHlwZT86IHN0cmluZztcclxuICBlbnRpdHlJZD86IHN0cmluZztcclxuICBvbGRWYWx1ZT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgbmV3VmFsdWU/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIG9sZFZhbHVlcz86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgbmV3VmFsdWVzPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxuICBpcEFkZHJlc3M/OiBzdHJpbmc7XHJcbiAgdXNlckFnZW50Pzogc3RyaW5nO1xyXG59KSB7XHJcbiAgY29uc3Qgb2xkVmFsdWUgPSBwYXJhbXMub2xkVmFsdWUgPz8gcGFyYW1zLm9sZFZhbHVlcztcclxuICBjb25zdCBuZXdWYWx1ZSA9IHBhcmFtcy5uZXdWYWx1ZSA/PyBwYXJhbXMubmV3VmFsdWVzO1xyXG4gIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW4uZnJvbSgnYXVkaXRfbG9ncycpLmluc2VydCh7XHJcbiAgICBhZG1pbl9pZDogcGFyYW1zLmFkbWluSWQsXHJcbiAgICBhY3Rpb246IHBhcmFtcy5hY3Rpb24sXHJcbiAgICBlbnRpdHlfdHlwZTogcGFyYW1zLmVudGl0eVR5cGUsXHJcbiAgICBlbnRpdHlfaWQ6IHBhcmFtcy5lbnRpdHlJZCxcclxuICAgIG9sZF92YWx1ZTogb2xkVmFsdWUsXHJcbiAgICBuZXdfdmFsdWU6IG5ld1ZhbHVlLFxyXG4gICAgaXBfYWRkcmVzczogcGFyYW1zLmlwQWRkcmVzcyxcclxuICAgIHVzZXJfYWdlbnQ6IHBhcmFtcy51c2VyQWdlbnQsXHJcbiAgfSk7XHJcblxyXG4gIGlmIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgYXVkaXQgbG9nOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlQWRtaW4iLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsImF1dGgiLCJhdXRvUmVmcmVzaFRva2VuIiwicGVyc2lzdFNlc3Npb24iLCJnZXRTZXR0aW5ncyIsImRhdGEiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJjb25zb2xlIiwicmVkdWNlIiwiYWNjIiwiaXRlbSIsImtleSIsInZhbHVlIiwiZ2V0U2V0dGluZyIsImVxIiwic2luZ2xlIiwidXBkYXRlU2V0dGluZyIsInVwZGF0ZSIsImNyZWF0ZUF1ZGl0TG9nIiwicGFyYW1zIiwib2xkVmFsdWUiLCJvbGRWYWx1ZXMiLCJuZXdWYWx1ZSIsIm5ld1ZhbHVlcyIsImluc2VydCIsImFkbWluX2lkIiwiYWRtaW5JZCIsImFjdGlvbiIsImVudGl0eV90eXBlIiwiZW50aXR5VHlwZSIsImVudGl0eV9pZCIsImVudGl0eUlkIiwib2xkX3ZhbHVlIiwibmV3X3ZhbHVlIiwiaXBfYWRkcmVzcyIsImlwQWRkcmVzcyIsInVzZXJfYWdlbnQiLCJ1c2VyQWdlbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/admin.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/server.ts":
/*!********************************!*\
  !*** ./lib/supabase/server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ createClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\nfunction createClient() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://cxmiphavaltkeyobaptg.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN4bWlwaGF2YWx0a2V5b2JhcHRnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1Njk4NzIsImV4cCI6MjA4NDE0NTg3Mn0.zqiB5uvZcLmPEIMNJ-AYDh72EinU_QbvtNo9SBP0m1E\", {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value,\n                        ...options\n                    });\n                } catch (error) {\n                // Server component'te set çalışmaz, ignore\n                }\n            },\n            remove (name, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value: \"\",\n                        ...options\n                    });\n                } catch (error) {\n                // Ignore\n                }\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1RTtBQUNoQztBQUVoQyxTQUFTRTtJQUNkLE1BQU1DLGNBQWNGLHFEQUFPQTtJQUUzQixPQUFPRCxpRUFBa0JBLENBQ3ZCSSwwQ0FBb0MsRUFDcENBLGtOQUF5QyxFQUN6QztRQUNFSCxTQUFTO1lBQ1BPLEtBQUlDLElBQVk7Z0JBQ2QsT0FBT04sWUFBWUssR0FBRyxDQUFDQyxPQUFPQztZQUNoQztZQUNBQyxLQUFJRixJQUFZLEVBQUVDLEtBQWEsRUFBRUUsT0FBc0I7Z0JBQ3JELElBQUk7b0JBQ0ZULFlBQVlRLEdBQUcsQ0FBQzt3QkFBRUY7d0JBQU1DO3dCQUFPLEdBQUdFLE9BQU87b0JBQUM7Z0JBQzVDLEVBQUUsT0FBT0MsT0FBTztnQkFDZCwyQ0FBMkM7Z0JBQzdDO1lBQ0Y7WUFDQUMsUUFBT0wsSUFBWSxFQUFFRyxPQUFzQjtnQkFDekMsSUFBSTtvQkFDRlQsWUFBWVEsR0FBRyxDQUFDO3dCQUFFRjt3QkFBTUMsT0FBTzt3QkFBSSxHQUFHRSxPQUFPO29CQUFDO2dCQUNoRCxFQUFFLE9BQU9DLE9BQU87Z0JBQ2QsU0FBUztnQkFDWDtZQUNGO1FBQ0Y7SUFDRjtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbW9uZWxpeGEvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzPzY2MjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50LCB0eXBlIENvb2tpZU9wdGlvbnMgfSBmcm9tICdAc3VwYWJhc2Uvc3NyJztcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2xpZW50KCkge1xuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcblxuICByZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICAgIHtcbiAgICAgIGNvb2tpZXM6IHtcbiAgICAgICAgZ2V0KG5hbWU6IHN0cmluZykge1xuICAgICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXQobmFtZSk/LnZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBvcHRpb25zOiBDb29raWVPcHRpb25zKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldCh7IG5hbWUsIHZhbHVlLCAuLi5vcHRpb25zIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBTZXJ2ZXIgY29tcG9uZW50J3RlIHNldCDDp2FsxLHFn21heiwgaWdub3JlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZW1vdmUobmFtZTogc3RyaW5nLCBvcHRpb25zOiBDb29raWVPcHRpb25zKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldCh7IG5hbWUsIHZhbHVlOiAnJywgLi4ub3B0aW9ucyB9KTtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gSWdub3JlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9XG4gICk7XG59Il0sIm5hbWVzIjpbImNyZWF0ZVNlcnZlckNsaWVudCIsImNvb2tpZXMiLCJjcmVhdGVDbGllbnQiLCJjb29raWVTdG9yZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImdldCIsIm5hbWUiLCJ2YWx1ZSIsInNldCIsIm9wdGlvbnMiLCJlcnJvciIsInJlbW92ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/cookie","vendor-chunks/stripe","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/qs","vendor-chunks/call-bind-apply-helpers","vendor-chunks/get-proto","vendor-chunks/object-inspect","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/side-channel","vendor-chunks/side-channel-weakmap","vendor-chunks/side-channel-map","vendor-chunks/side-channel-list","vendor-chunks/hasown","vendor-chunks/get-intrinsic","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/call-bound"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsettings%2Fpayments%2Froute&page=%2Fapi%2Fsettings%2Fpayments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsettings%2Fpayments%2Froute.ts&appDir=C%3A%5CUsers%5CSonat%5CDocuments%5CVS-CODE-PROJECTS%5CPAY-STRUCTURE-ALL%5CPAY-STRUCTURE%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CSonat%5CDocuments%5CVS-CODE-PROJECTS%5CPAY-STRUCTURE-ALL%5CPAY-STRUCTURE&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();